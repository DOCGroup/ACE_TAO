<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>AMICCM Tutorial Hello - Implementation exec</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.2  (Win32)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Marijke Hengstmengel">
	<META NAME="CHANGED" CONTENT="20100625;14523700">
	<META NAME="CHANGEDBY" CONTENT="Marijke Hengstmengel">
	<META NAME="CHANGEDBY" CONTENT="Marijke Hengstmengel">
	<!--//$Id$  -->
	<STYLE TYPE="text/css">
	<!--
		H2.cjk { font-family: "SimSun" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="nl-NL" DIR="ltr">
<TABLE WIDTH="100%" BORDER=0 CELLPADDING=2 CELLSPACING=2 STYLE="PAGE-BREAK-BEFORE: always">
	<TR>
		<TD>
			<P ALIGN=left><A href="03_executors.html">Previous</A></P></TD>
		<TD>
			<P ALIGN=center><IMG border=0 name=graphics1 align=bottom src="images/images.png" width="4%" height="5%" ></P></TD>
		<TD>
			<P ALIGN=right><A href="05_compilation.html">Next</A></P></TD></TR></TABLE>
<HR>
<H1>Implementation executors</H1>
<H2 CLASS="western">AMI4CCM basics</H2>
<UL>
	<LI><P>The writer has basically only to write 3 idl files, first the
	one that defines the common interface between the Sender and
	Receiver , second the interface for the Sender and third the
	interface for the Receiver. In this tutorial are that the IDL files
	Hello_MyFoo_obj.idl, Hello_Sender_comp.idl and the
	Hello_Receiver_comp.idl . <BR>Naturally, it is possible that there are more IDL-files 
  to be used, as in this example the Hello_Common_defn.idl file for the common 
  definitions.</P>
	<LI><P>The Receiver component ('server') has no idea which 
  component (AMI connector or Sender) uses his interface.</P>
	<LI><P>The Connector, the AMI-Component, will be generated by 
  the IDL compiler by implying ami4ccm.idl</P>
	<LI><P>In the Sender executor the handling of the AMI 
  callbacks and also the asynchronous and synchronous invocations must be 
  coded.</P></LI></UL>
<H2 CLASS="western">Example</H2>
<P>The Sender component of this Hello tutorial invokes some 
asynchronous methods and some synchronous methods. For asynchronous invocations, 
the Sender component uses the AMI4CCM_MyFoo_obj interface of the AMI component 
and provides the AMI4CCM_MyFoo_objReplyHandler interface to the AMI 
component.</P>
<P>For synchronous invocations, the Sender component uses 
the MyFoo_obj interface (which the Receiver provides).</P>
<P STYLE="MARGIN-BOTTOM: 0cm">The receiver just implements 
the interface provided by the application programmer. The Receiver should have 
no idea which component (in this case Sender or AMI) uses his interface!</P>
<P STYLE="MARGIN-BOTTOM: 0cm"><BR></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=4><B>Sender_comp_exec.cpp</B></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; FONT-WEIGHT: normal"><FONT SIZE=3>In de ccm_activate method, first retrieve the 
receptacles:</FONT></P>
<P LANG="" STYLE="MARGIN-BOTTOM: 0cm; FONT-WEIGHT: normal">
<FONT SIZE=3>Asynchronous:</FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; MARGIN-LEFT: 1cm; MARGIN-RIGHT: 0px" dir=ltr> 
<FONT SIZE=2><SPAN LANG=""><SPAN STYLE="FONT-WEIGHT: normal">::Hello::AMI4CCM_MyFoo_obj_var 
asynch_foo</SPAN></SPAN></FONT><FONT SIZE=2><SPAN LANG=""><B> =</B></SPAN></FONT><FONT SIZE=2><SPAN LANG=""> </SPAN></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">this</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">-&gt;context_-&gt;get_connection_sendc_run_my_foo();</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=3><FONT COLOR="#000000"><SPAN LANG="">Synchronous:</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; MARGIN-LEFT: 1cm"><FONT COLOR="#000000">
<FONT SIZE=2><SPAN LANG="">::Hello::MyFoo_obj_var synch_foo 
=</SPAN></FONT></FONT><FONT SIZE=2><SPAN LANG=""> </SPAN></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">this</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">-&gt;context_-&gt;get_connection_run_my_foo 
();</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><BR></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=3><FONT COLOR="#000000"><SPAN LANG="">After retrieving the receptacles, make the desired 
asynchronus and synchronous invocations.</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=3><FONT COLOR="#000000"><SPAN LANG="">The asynchronous methods have the prefix sendc_. The first 
argument is the Reply handler.</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; MARGIN-LEFT: 1cm"><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">my_foo_ami_-&gt;sendc_foo 
(</SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">new</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> MyFoo_obj_callback_exec_i (), </SPAN></FONT></FONT><FONT COLOR="#a31515"><FONT SIZE=2><SPAN LANG="">"Do something 
asynchronous"</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">);</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=3><FONT COLOR="#000000"><SPAN LANG="">The same synchronous method: </SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; MARGIN-LEFT: 1cm"><FONT COLOR="#000000">
<FONT SIZE=2><SPAN LANG="">CORBA::Long result = my_foo_ami_-&gt;foo 
(</SPAN></FONT></FONT><FONT COLOR="#a31515"><FONT SIZE=2><SPAN LANG="">"Do something 
synchronous"</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">, 
out_str.out());</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><BR></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=3><FONT COLOR="#000000"><SPAN LANG="">For the asynchronus methods the implied Reply Handler 
interface for each method must be coded.</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=3><FONT COLOR="#000000"><SPAN LANG="">Example foo callback:</SPAN></FONT></FONT></P>
<P LANG="" STYLE="MARGIN-BOTTOM: 0cm"><FONT COLOR="#0000ff"><FONT SIZE=2>void<BR></FONT></FONT><FONT COLOR="#000000"> 
<SPAN LANG=""><FONT SIZE=2>MyFoo_obj_callback_exec_i::foo (::CORBA::Long 
ami_return_val,</FONT></FONT></SPAN><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> </SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">const</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> </SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">char</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> * answer)<BR></SPAN></FONT></FONT><FONT COLOR="#000000">  <FONT SIZE=2>{<BR></FONT></FONT><FONT COLOR="#008000"><FONT SIZE=2><SPAN LANG=""><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;</FONT>/* 
Your code here. */<BR></SPAN></FONT></FONT><FONT COLOR="#000000">
<FONT SIZE=2><FONT 
color=#0000ff>&nbsp;&nbsp;&nbsp;</FONT>ACE_DEBUG 
((LM_DEBUG,<BR></FONT></FONT><FONT COLOR="#000000">
  <FONT SIZE=2><SPAN LANG=""><FONT 
color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT>ACE_TEXT(</SPAN></FONT></FONT><FONT COLOR="#a31515"><FONT SIZE=2><SPAN LANG="">"Sender:\tMyFoo AMI Callback from 
foo:"</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">)<BR></SPAN></FONT></FONT><FONT COLOR="#000000">
  <FONT SIZE=2><SPAN LANG=""><FONT 
color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT>ACE_TEXT(</SPAN></FONT></FONT><FONT COLOR="#a31515"><FONT SIZE=2><SPAN LANG="">"result &lt;%u&gt; answer 
&lt;%C&gt;\n"</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">),<BR></SPAN></FONT></FONT><FONT COLOR="#000000">
  <FONT SIZE=2><FONT 
color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT>ami_return_val, 
answer));<BR></FONT></FONT><FONT COLOR="#000000">  <FONT SIZE=2>}</FONT></FONT></P>
<P LANG="" STYLE="MARGIN-BOTTOM: 0cm"><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">void<BR></SPAN></FONT></FONT><FONT COLOR="#000000"> 
<FONT SIZE=2>MyFoo_obj_callback_exec_i::foo_excep ( 
::CCM_AMI::ExceptionHolder * excep_holder)<BR></FONT></FONT><FONT COLOR="#000000">  <FONT SIZE=2>{<BR></FONT></FONT><FONT COLOR="#008000"><FONT SIZE=2><SPAN LANG=""><FONT 
color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;</FONT>/* Your code here. 
*/<BR></SPAN></FONT></FONT><FONT COLOR="#000000"> <FONT SIZE=2><SPAN LANG="">}</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><FONT SIZE=4><B>Receiver_comp_exec.cpp</B></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; FONT-WEIGHT: normal"><FONT SIZE=4 STYLE="FONT-SIZE: 16pt">I<FONT SIZE=3>n this file the interface methods must be 
programmed.</FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm; FONT-WEIGHT: normal"><FONT SIZE=3>Example foo method:</FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"> <FONT SIZE=2><SPAN STYLE="FONT-WEIGHT: normal"><SPAN LANG="">::CORBA::Long 
</SPAN></SPAN></FONT><FONT SIZE=2><SPAN LANG="">
MyFoo_obj_exec_i::foo (</SPAN></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">const</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> </SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">char</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> * in_str, ::CORBA::String_out 
answer)<BR></SPAN></FONT></FONT><FONT COLOR="#000000">  <FONT SIZE=2>{<BR></FONT></FONT><FONT COLOR="#008000"><FONT SIZE=2><SPAN LANG=""><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;</FONT>/* Your code 
here. */<BR></SPAN></FONT></FONT><FONT COLOR="#000000">
       <FONT SIZE=2><SPAN LANG=""><FONT 
color=#0000ff>&nbsp;&nbsp;&nbsp;</FONT>answer = CORBA::string_dup 
(</SPAN></FONT></FONT><FONT COLOR="#a31515"><FONT SIZE=2><SPAN LANG="">"This is my answer : 
Hi"</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG="">);<BR></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT SIZE=2><SPAN LANG="">&nbsp;&nbsp;&nbsp;return</SPAN></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=2><SPAN LANG=""> ACE_OS::rand () % 
100;<BR></SPAN></FONT></FONT><FONT COLOR="#000000">
<FONT SIZE=2><SPAN LANG="">}</SPAN></FONT></FONT></P>
<P STYLE="MARGIN-BOTTOM: 0cm"><BR></P>
<TABLE WIDTH="100%" BORDER=0 CELLPADDING=2 CELLSPACING=2>
	<TR>
		<TD>
			<P ALIGN=left><A href="03_executors.html">Previous</A></P></TD>
		<TD>
			<P ALIGN=center><IMG border=0 name=graphics2 align=bottom src="images/images.png" width="4%" height="5%" ></P></TD>
		<TD>
			<P ALIGN=right><A href="05_compilation.html">Next</A></P></TD></TR></TABLE>
<P><BR><BR></P>
</BODY>
</HTML>
