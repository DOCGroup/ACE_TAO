<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.04 [en] (X11; I; Linux 2.0.32 i486) [Netscape]">
   <META NAME="Author" CONTENT="Billy Quinn">
   <META NAME="Description" CONTENT="A first step towards using ACE productively">
   <TITLE>ACE Tutorial 005</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#000FFF" VLINK="#FF0F0F">

<CENTER><B><FONT SIZE=+2>ACE Tutorial 005</FONT></B></CENTER>

<CENTER><B><FONT SIZE=+2>On the road to a multithreaded server</FONT></B></CENTER>


<P>
<HR WIDTH="100%">

<P>Now, let's take a look at <I><A HREF="client_acceptor.h">client_acceptor.h</A></I>.&nbsp;
Since I went on about how it does all the work of letting clients connect
to us, it must be rather complext.&nbsp; Right?&nbsp; Wrong.

<P>The more you use ACE, the more you'll find that they've already taken
care of most details for you.&nbsp; With respect to the acceptance of client
connections:&nbsp; there just aren't that many ways to do it!&nbsp; The
ACE team has chosen an approach and created a C++&nbsp;template that does
all of the work for you.&nbsp; All you're required to do is provide it
with an object type to instantiate when a new connection arrives.

<P>
<HR WIDTH="100%">

<P><FONT FACE="Arial,Helvetica">// $Id$</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">#ifndef&nbsp; CLIENT_ACCEPTOR_H</FONT>
<BR><FONT FACE="Arial,Helvetica">#define CLIENT_ACCEPTOR_H</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">/*</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;The ACE_Acceptor&lt;> template lives
in the ace/Acceptor.h header file.</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;You'll find a very consitent naming
convention between the ACE objects</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;and the headers where they can be
found.&nbsp; In general, the ACE object</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;<I>ACE_Foobar</I> will be found
in <I>ace/Foobar.h</I>.</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;*/</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">#include "ace/Acceptor.h"</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">/*</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;Since we want to work with sockets,
we'll need a SOCK_Acceptor to allow</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;the clients to connect to us.</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;*/</FONT>
<BR><FONT FACE="Arial,Helvetica">#include "ace/SOCK_Acceptor.h"</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">/*</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;The Client_Handler object we develop
will be used to handle clients</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;once they're connected.&nbsp; The
ACE_Acceptor&lt;> template's first parameter</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;requires such an object.&nbsp; In
some cases, you can get by with just a</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;forward declaration on the class,
in others you have to have the whole</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;thing.</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;*/</FONT>
<BR><FONT FACE="Arial,Helvetica">#include "client_handler.h"</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">/*</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;Parameterize the ACE_Acceptor&lt;>
such that it will listen for socket</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;connection attempts and create Client_Handler
objects when they happen.</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;In Tutorial 001, we wrote the basic
acceptor logic on our own before</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;we realized that ACE_Acceptor&lt;>
was available.&nbsp; You'll get spoiled using</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;the ACE templates because they take
away a lot of the tedious details!</FONT>
<BR><FONT FACE="Arial,Helvetica">&nbsp;*/</FONT>
<BR><FONT FACE="Arial,Helvetica">typedef ACE_Acceptor &lt; Client_Handler,
ACE_SOCK_ACCEPTOR > Client_Acceptor;</FONT><FONT FACE="Arial,Helvetica"></FONT>

<P><FONT FACE="Arial,Helvetica">#endif // CLIENT_ACCEPTOR_H</FONT>

<P>
<HR WIDTH="100%">
<CENTER>[<A HREF="..">Tutorial
Index</A>] [<A HREF="page04.html">Continue This Tutorial</A>]</CENTER>

</BODY>
</HTML>
