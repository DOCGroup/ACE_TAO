$Id$

This is a unit test for RTCORBA::SERVER_DECLARED priority model.

Scenario:
---------

The server creates
The server creates two objects: one with ClientProtocolPolicy set and
the other one without the policy being set.  The value of the
ClientProtocolPolicy is a single protocol specified using server
command-line option (see Options section below).  The client obtains
two object references and uses them to run five tests decribed
above. Finally, the client invokes <shutdown> method on the server to
terminate the processes.

To run (on Unix):
-------
$./server [-s <ior_output_file1> -c <ior_output_file2> -p <profile_id>]
$./client [-s <ior1> -c <ior2> -p <profile_id>] -ORBdebuglevel 1


Options:
--------
         Server:

-s <ior_output_file1>   Default: test1.ior
                        Filename for output of IOR for the object that
                        had ClientProtocolPolicy set on the server.

-c <ior_output_file2>   Default: test2.ior
                        Filename for output of IOR for the object that
                        did not have ClientProtocolPolicy set on the
                        server.

-p <profile_id>         Default: 0 (IIOP)
                        Protocol used as a ClientProtocolPolicy value
                        for one of the server's objects.

         Client:

-s <ior_output_file1>   Default: file://test1.ior
                        IOR for the object that had
                        ClientProtocolPolicy set on the server.

-c <ior_output_file2>   Default: file://test2.ior
                        IOR for the object that did not have
                        ClientProtocolPolicy set on the server.

-p <profile_id>         Default: 0 (IIOP)
                        Protocol used as a ClientProtocolPolicy value
                        on the client.

-ORBdebuglevel 1        Recommended ORB option for the client in order to see
                        which protocols are being used in each
                        mini-test for client-server communication.



Expected output:
----------------
Below is the expected output from run_test.pl on a Windows
platform. See run_test.pl for command-line options used for client and
server.  NOTE: expected output differs on unix.

In general, the output must contain "BAD_PARAM exception is caught as
expected.", and server declared priorities must equal corresponding
servant thread priorities.


********** RTCORBA SERVER_DECLARED Priority Unit Test


Activated object one as <IOR:010000000d00000049444c3a546573743a312e3000000000010
0000000000000b2000000010102cd0a0000006c6f63616c686f7374004b052300000014010f004e5
354790af039d4650c000100000001000000000000000100000001000000cd0400000000000000080
0000001cdcdcd004f4154010000001400000001cdcdcd01000100000000000901010000000000024
f41541a00000001cdcdcd010000000a0000006c6f63616c686f7374004b050300cdcd020000001a0
0000001cdcdcd01000000020041540a00000001cdcdcd010000000300>


Activated object two as <IOR:010000000d00000049444c3a546573743a312e3000000000010
0000000000000b2000000010102cd0a0000006c6f63616c686f7374004e052300000014010f004e5
354790af039d4650c000100000001000000010000000100000002000000cd0400000000000000080
0000001cdcdcd004f4154010000001400000001cdcdcd01000100000000000901010000000000024
f41541a00000001cdcdcd010000000a0000006c6f63616c686f7374004e050500cdcd020000001a0
0000001cdcdcd01000000020041540a00000001cdcdcd010000000500>

BAD_PARAM exception is caught as expected.
Server_Declared priority: 3  Servant thread priority: 3
Server_Declared priority: 5  Servant thread priority: 5
Server_Declared priority: 3  Servant thread priority: 3
Server_Declared priority: 5  Servant thread priority: 5
Server_Declared priority: 3  Servant thread priority: 3
Server_Declared priority: 5  Servant thread priority: 5
Server_Declared priority: 3  Servant thread priority: 3
Server_Declared priority: 5  Servant thread priority: 5
Server_Declared priority: 3  Servant thread priority: 3
Server_Declared priority: 5  Servant thread priority: 5
Server ORB event loop finished




Below is the expected output from run_test.pl on a Unix platform. See
run_test.pl for command-line options used for client and server.
NOTE: expected output differs on windows.
