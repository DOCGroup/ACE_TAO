--- orig/MessagingC.h	Sun Apr 30 18:03:08 2000
+++ MessagingC.h	Sun Apr 30 18:06:01 2000
@@ -11,21 +11,32 @@
 #define _TAO_IDL_ORIG_MESSAGINGC_H_
 
 #include "ace/pre.h"
-#include "tao/corba.h"
+#include "tao/orbconf.h"
 
-#if defined (ACE_HAS_MINIMUM_IOSTREAMH_INCLUSION)
-#include "ace/streams.h"
-#endif /* ACE_HAS_MINIMUM_IOSTREAMH_INCLUSION */
+#if (TAO_HAS_CORBA_MESSAGING == 1)
+
+#if (TAO_HAS_AMI_CALLBACK == 1) || (TAO_HAS_AMI_POLLER == 1)
+#include "tao/ValueBase.h"
+#include "tao/ValueFactory.h"
+#endif /* TAO_HAS_AMI_CALLBACK == 1 || TAO_HAS_AMI_POLLER == 1 */
+
+#include "tao/corbafwd.h"
 
 #if !defined (ACE_LACKS_PRAGMA_ONCE)
 # pragma once
 #endif /* ACE_LACKS_PRAGMA_ONCE */
 
-#include "corbafwd.h"
-#include "TimeBaseC.h"
-#include "IOPC.h"
-#include "PolicyC.h"
-#include "PollableC.h"
+#include "tao/Any.h"
+#include "tao/CDR.h"
+#include "tao/TimeBaseC.h"
+#include "tao/PolicyC.h"
+#include "tao/IOPC.h"
+#include "tao/PollableC.h"
+
+#if (TAO_HAS_SMART_PROXIES == 1)
+#include "tao/Smart_Proxies.h"
+#include "ace/Singleton.h"
+#endif /*TAO_HAS_SMART_PROXIES == 1*/
 
 #if defined (TAO_EXPORT_MACRO)
 #undef TAO_EXPORT_MACRO
@@ -46,6 +57,11 @@
 #pragma warning(disable:4250)
 #endif /* _MSC_VER */
 
+#if defined(TRANSPARENT)
+// Some platforms define this macro for ioctl()
+#undef TRANSPARENT
+#endif
+
 TAO_NAMESPACE  Messaging
 {
   typedef CORBA::Short RebindMode;
@@ -104,6 +120,8 @@
 
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::UShort ORDER_DEADLINE;
 
+#if (TAO_HAS_REBIND_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong REBIND_POLICY_TYPE;
 
 
@@ -112,7 +130,7 @@
 
   class RebindPolicy;
   typedef RebindPolicy *RebindPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -126,14 +144,14 @@
     RebindPolicy_var (RebindPolicy_ptr);
     RebindPolicy_var (const RebindPolicy_var &); // copy constructor
     ~RebindPolicy_var (void); // destructor
-    
+
     RebindPolicy_var &operator= (RebindPolicy_ptr);
     RebindPolicy_var &operator= (const RebindPolicy_var &);
     RebindPolicy_ptr operator-> (void) const;
-    
+
     operator const RebindPolicy_ptr &() const;
     operator RebindPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RebindPolicy_ptr in (void) const;
     RebindPolicy_ptr &inout (void);
     RebindPolicy_ptr &out (void);
@@ -163,7 +181,7 @@
     operator RebindPolicy_ptr &();
     RebindPolicy_ptr &ptr (void);
     RebindPolicy_ptr operator-> (void);
-    
+
   private:
     RebindPolicy_ptr &ptr_;
   };
@@ -187,12 +205,12 @@
     static RebindPolicy_ptr _duplicate (RebindPolicy_ptr obj);
     static RebindPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RebindPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RebindPolicy_ptr _nil (void)
@@ -201,7 +219,7 @@
       }
 
     virtual Messaging::RebindMode rebind_mode (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -209,7 +227,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -223,6 +241,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_REBIND_POLICY == 1 */
+
+#if (TAO_HAS_SYNC_SCOPE_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong SYNC_SCOPE_POLICY_TYPE;
 
 
@@ -231,7 +253,7 @@
 
   class SyncScopePolicy;
   typedef SyncScopePolicy *SyncScopePolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -245,14 +267,14 @@
     SyncScopePolicy_var (SyncScopePolicy_ptr);
     SyncScopePolicy_var (const SyncScopePolicy_var &); // copy constructor
     ~SyncScopePolicy_var (void); // destructor
-    
+
     SyncScopePolicy_var &operator= (SyncScopePolicy_ptr);
     SyncScopePolicy_var &operator= (const SyncScopePolicy_var &);
     SyncScopePolicy_ptr operator-> (void) const;
-    
+
     operator const SyncScopePolicy_ptr &() const;
     operator SyncScopePolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     SyncScopePolicy_ptr in (void) const;
     SyncScopePolicy_ptr &inout (void);
     SyncScopePolicy_ptr &out (void);
@@ -282,7 +304,7 @@
     operator SyncScopePolicy_ptr &();
     SyncScopePolicy_ptr &ptr (void);
     SyncScopePolicy_ptr operator-> (void);
-    
+
   private:
     SyncScopePolicy_ptr &ptr_;
   };
@@ -306,12 +328,12 @@
     static SyncScopePolicy_ptr _duplicate (SyncScopePolicy_ptr obj);
     static SyncScopePolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static SyncScopePolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static SyncScopePolicy_ptr _nil (void)
@@ -320,7 +342,7 @@
       }
 
     virtual Messaging::SyncScope synchronization (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -328,7 +350,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -342,11 +364,15 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_SYNC_SCOPE_POLICY == 1 */
+
+#if (TAO_HAS_PRIORITY_POLICIES == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong REQUEST_PRIORITY_POLICY_TYPE;
 
   struct PriorityRange;
   class PriorityRange_var;
-  
+
   struct TAO_Export PriorityRange
   {
 
@@ -368,18 +394,18 @@
     PriorityRange_var (const PriorityRange_var &); // copy constructor
     PriorityRange_var (const PriorityRange &); // fixed-size types only
     ~PriorityRange_var (void); // destructor
-    
+
     PriorityRange_var &operator= (PriorityRange *);
     PriorityRange_var &operator= (const PriorityRange_var &);
     PriorityRange_var &operator= (const PriorityRange &); // fixed-size types only
     PriorityRange *operator-> (void);
     const PriorityRange *operator-> (void) const;
-    
+
     operator const PriorityRange &() const;
     operator PriorityRange &();
     operator PriorityRange &() const;
-    
-    // in, inout, out, _retn 
+
+    // in, inout, out, _retn
     const PriorityRange &in (void) const;
     PriorityRange &inout (void);
     PriorityRange &out (void);
@@ -400,7 +426,7 @@
 
   class RequestPriorityPolicy;
   typedef RequestPriorityPolicy *RequestPriorityPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -414,14 +440,14 @@
     RequestPriorityPolicy_var (RequestPriorityPolicy_ptr);
     RequestPriorityPolicy_var (const RequestPriorityPolicy_var &); // copy constructor
     ~RequestPriorityPolicy_var (void); // destructor
-    
+
     RequestPriorityPolicy_var &operator= (RequestPriorityPolicy_ptr);
     RequestPriorityPolicy_var &operator= (const RequestPriorityPolicy_var &);
     RequestPriorityPolicy_ptr operator-> (void) const;
-    
+
     operator const RequestPriorityPolicy_ptr &() const;
     operator RequestPriorityPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RequestPriorityPolicy_ptr in (void) const;
     RequestPriorityPolicy_ptr &inout (void);
     RequestPriorityPolicy_ptr &out (void);
@@ -451,7 +477,7 @@
     operator RequestPriorityPolicy_ptr &();
     RequestPriorityPolicy_ptr &ptr (void);
     RequestPriorityPolicy_ptr operator-> (void);
-    
+
   private:
     RequestPriorityPolicy_ptr &ptr_;
   };
@@ -475,12 +501,12 @@
     static RequestPriorityPolicy_ptr _duplicate (RequestPriorityPolicy_ptr obj);
     static RequestPriorityPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RequestPriorityPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RequestPriorityPolicy_ptr _nil (void)
@@ -489,7 +515,7 @@
       }
 
     virtual Messaging::PriorityRange priority_range (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -497,7 +523,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -519,7 +545,7 @@
 
   class ReplyPriorityPolicy;
   typedef ReplyPriorityPolicy *ReplyPriorityPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -533,14 +559,14 @@
     ReplyPriorityPolicy_var (ReplyPriorityPolicy_ptr);
     ReplyPriorityPolicy_var (const ReplyPriorityPolicy_var &); // copy constructor
     ~ReplyPriorityPolicy_var (void); // destructor
-    
+
     ReplyPriorityPolicy_var &operator= (ReplyPriorityPolicy_ptr);
     ReplyPriorityPolicy_var &operator= (const ReplyPriorityPolicy_var &);
     ReplyPriorityPolicy_ptr operator-> (void) const;
-    
+
     operator const ReplyPriorityPolicy_ptr &() const;
     operator ReplyPriorityPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     ReplyPriorityPolicy_ptr in (void) const;
     ReplyPriorityPolicy_ptr &inout (void);
     ReplyPriorityPolicy_ptr &out (void);
@@ -570,7 +596,7 @@
     operator ReplyPriorityPolicy_ptr &();
     ReplyPriorityPolicy_ptr &ptr (void);
     ReplyPriorityPolicy_ptr operator-> (void);
-    
+
   private:
     ReplyPriorityPolicy_ptr &ptr_;
   };
@@ -594,12 +620,12 @@
     static ReplyPriorityPolicy_ptr _duplicate (ReplyPriorityPolicy_ptr obj);
     static ReplyPriorityPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyPriorityPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyPriorityPolicy_ptr _nil (void)
@@ -608,7 +634,7 @@
       }
 
     virtual Messaging::PriorityRange priority_range (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -616,7 +642,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -630,6 +656,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_PRIORITY_POLICIES == 1 */
+
+#if (TAO_HAS_REQUEST_START_TIME_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong REQUEST_START_TIME_POLICY_TYPE;
 
 
@@ -638,7 +668,7 @@
 
   class RequestStartTimePolicy;
   typedef RequestStartTimePolicy *RequestStartTimePolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -652,14 +682,14 @@
     RequestStartTimePolicy_var (RequestStartTimePolicy_ptr);
     RequestStartTimePolicy_var (const RequestStartTimePolicy_var &); // copy constructor
     ~RequestStartTimePolicy_var (void); // destructor
-    
+
     RequestStartTimePolicy_var &operator= (RequestStartTimePolicy_ptr);
     RequestStartTimePolicy_var &operator= (const RequestStartTimePolicy_var &);
     RequestStartTimePolicy_ptr operator-> (void) const;
-    
+
     operator const RequestStartTimePolicy_ptr &() const;
     operator RequestStartTimePolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RequestStartTimePolicy_ptr in (void) const;
     RequestStartTimePolicy_ptr &inout (void);
     RequestStartTimePolicy_ptr &out (void);
@@ -689,7 +719,7 @@
     operator RequestStartTimePolicy_ptr &();
     RequestStartTimePolicy_ptr &ptr (void);
     RequestStartTimePolicy_ptr operator-> (void);
-    
+
   private:
     RequestStartTimePolicy_ptr &ptr_;
   };
@@ -713,12 +743,12 @@
     static RequestStartTimePolicy_ptr _duplicate (RequestStartTimePolicy_ptr obj);
     static RequestStartTimePolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RequestStartTimePolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RequestStartTimePolicy_ptr _nil (void)
@@ -727,7 +757,7 @@
       }
 
     virtual TimeBase::UtcT start_time (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -735,7 +765,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -749,6 +779,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_REQUEST_START_TIME_POLICY == 1 */
+
+#if (TAO_HAS_REQUEST_END_TIME_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong REQUEST_END_TIME_POLICY_TYPE;
 
 
@@ -757,7 +791,7 @@
 
   class RequestEndTimePolicy;
   typedef RequestEndTimePolicy *RequestEndTimePolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -771,14 +805,14 @@
     RequestEndTimePolicy_var (RequestEndTimePolicy_ptr);
     RequestEndTimePolicy_var (const RequestEndTimePolicy_var &); // copy constructor
     ~RequestEndTimePolicy_var (void); // destructor
-    
+
     RequestEndTimePolicy_var &operator= (RequestEndTimePolicy_ptr);
     RequestEndTimePolicy_var &operator= (const RequestEndTimePolicy_var &);
     RequestEndTimePolicy_ptr operator-> (void) const;
-    
+
     operator const RequestEndTimePolicy_ptr &() const;
     operator RequestEndTimePolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RequestEndTimePolicy_ptr in (void) const;
     RequestEndTimePolicy_ptr &inout (void);
     RequestEndTimePolicy_ptr &out (void);
@@ -808,7 +842,7 @@
     operator RequestEndTimePolicy_ptr &();
     RequestEndTimePolicy_ptr &ptr (void);
     RequestEndTimePolicy_ptr operator-> (void);
-    
+
   private:
     RequestEndTimePolicy_ptr &ptr_;
   };
@@ -832,12 +866,12 @@
     static RequestEndTimePolicy_ptr _duplicate (RequestEndTimePolicy_ptr obj);
     static RequestEndTimePolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RequestEndTimePolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RequestEndTimePolicy_ptr _nil (void)
@@ -846,7 +880,7 @@
       }
 
     virtual TimeBase::UtcT end_time (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -854,7 +888,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -868,6 +902,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_REQUEST_END_TIME_POLICY == 1 */
+
+#if (TAO_HAS_REPLY_START_TIME_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong REPLY_START_TIME_POLICY_TYPE;
 
 
@@ -876,7 +914,7 @@
 
   class ReplyStartTimePolicy;
   typedef ReplyStartTimePolicy *ReplyStartTimePolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -890,14 +928,14 @@
     ReplyStartTimePolicy_var (ReplyStartTimePolicy_ptr);
     ReplyStartTimePolicy_var (const ReplyStartTimePolicy_var &); // copy constructor
     ~ReplyStartTimePolicy_var (void); // destructor
-    
+
     ReplyStartTimePolicy_var &operator= (ReplyStartTimePolicy_ptr);
     ReplyStartTimePolicy_var &operator= (const ReplyStartTimePolicy_var &);
     ReplyStartTimePolicy_ptr operator-> (void) const;
-    
+
     operator const ReplyStartTimePolicy_ptr &() const;
     operator ReplyStartTimePolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     ReplyStartTimePolicy_ptr in (void) const;
     ReplyStartTimePolicy_ptr &inout (void);
     ReplyStartTimePolicy_ptr &out (void);
@@ -927,7 +965,7 @@
     operator ReplyStartTimePolicy_ptr &();
     ReplyStartTimePolicy_ptr &ptr (void);
     ReplyStartTimePolicy_ptr operator-> (void);
-    
+
   private:
     ReplyStartTimePolicy_ptr &ptr_;
   };
@@ -951,12 +989,12 @@
     static ReplyStartTimePolicy_ptr _duplicate (ReplyStartTimePolicy_ptr obj);
     static ReplyStartTimePolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyStartTimePolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyStartTimePolicy_ptr _nil (void)
@@ -965,7 +1003,7 @@
       }
 
     virtual TimeBase::UtcT start_time (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -973,7 +1011,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -987,6 +1025,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_REPLY_START_TIME_POLICY == 1 */
+
+#if (TAO_HAS_REPLY_END_TIME_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong REPLY_END_TIME_POLICY_TYPE;
 
 
@@ -995,7 +1037,7 @@
 
   class ReplyEndTimePolicy;
   typedef ReplyEndTimePolicy *ReplyEndTimePolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -1009,14 +1051,14 @@
     ReplyEndTimePolicy_var (ReplyEndTimePolicy_ptr);
     ReplyEndTimePolicy_var (const ReplyEndTimePolicy_var &); // copy constructor
     ~ReplyEndTimePolicy_var (void); // destructor
-    
+
     ReplyEndTimePolicy_var &operator= (ReplyEndTimePolicy_ptr);
     ReplyEndTimePolicy_var &operator= (const ReplyEndTimePolicy_var &);
     ReplyEndTimePolicy_ptr operator-> (void) const;
-    
+
     operator const ReplyEndTimePolicy_ptr &() const;
     operator ReplyEndTimePolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     ReplyEndTimePolicy_ptr in (void) const;
     ReplyEndTimePolicy_ptr &inout (void);
     ReplyEndTimePolicy_ptr &out (void);
@@ -1046,7 +1088,7 @@
     operator ReplyEndTimePolicy_ptr &();
     ReplyEndTimePolicy_ptr &ptr (void);
     ReplyEndTimePolicy_ptr operator-> (void);
-    
+
   private:
     ReplyEndTimePolicy_ptr &ptr_;
   };
@@ -1070,12 +1112,12 @@
     static ReplyEndTimePolicy_ptr _duplicate (ReplyEndTimePolicy_ptr obj);
     static ReplyEndTimePolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyEndTimePolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyEndTimePolicy_ptr _nil (void)
@@ -1084,7 +1126,7 @@
       }
 
     virtual TimeBase::UtcT end_time (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -1092,7 +1134,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -1106,6 +1148,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_REPLY_END_TIME_POLICY == 1 */
+
+#if (TAO_HAS_RELATIVE_REQUEST_TIMEOUT_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong RELATIVE_REQ_TIMEOUT_POLICY_TYPE;
 
 
@@ -1114,7 +1160,7 @@
 
   class RelativeRequestTimeoutPolicy;
   typedef RelativeRequestTimeoutPolicy *RelativeRequestTimeoutPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -1128,14 +1174,14 @@
     RelativeRequestTimeoutPolicy_var (RelativeRequestTimeoutPolicy_ptr);
     RelativeRequestTimeoutPolicy_var (const RelativeRequestTimeoutPolicy_var &); // copy constructor
     ~RelativeRequestTimeoutPolicy_var (void); // destructor
-    
+
     RelativeRequestTimeoutPolicy_var &operator= (RelativeRequestTimeoutPolicy_ptr);
     RelativeRequestTimeoutPolicy_var &operator= (const RelativeRequestTimeoutPolicy_var &);
     RelativeRequestTimeoutPolicy_ptr operator-> (void) const;
-    
+
     operator const RelativeRequestTimeoutPolicy_ptr &() const;
     operator RelativeRequestTimeoutPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RelativeRequestTimeoutPolicy_ptr in (void) const;
     RelativeRequestTimeoutPolicy_ptr &inout (void);
     RelativeRequestTimeoutPolicy_ptr &out (void);
@@ -1165,7 +1211,7 @@
     operator RelativeRequestTimeoutPolicy_ptr &();
     RelativeRequestTimeoutPolicy_ptr &ptr (void);
     RelativeRequestTimeoutPolicy_ptr operator-> (void);
-    
+
   private:
     RelativeRequestTimeoutPolicy_ptr &ptr_;
   };
@@ -1189,12 +1235,12 @@
     static RelativeRequestTimeoutPolicy_ptr _duplicate (RelativeRequestTimeoutPolicy_ptr obj);
     static RelativeRequestTimeoutPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RelativeRequestTimeoutPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RelativeRequestTimeoutPolicy_ptr _nil (void)
@@ -1203,7 +1249,7 @@
       }
 
     virtual TimeBase::TimeT relative_expiry (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -1211,7 +1257,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -1225,6 +1271,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_RELATIVE_REQUEST_TIMEOUT_POLICY == 1 */
+
+#if (TAO_HAS_RELATIVE_ROUNDTRIP_TIMEOUT_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong RELATIVE_RT_TIMEOUT_POLICY_TYPE;
 
 
@@ -1233,7 +1283,7 @@
 
   class RelativeRoundtripTimeoutPolicy;
   typedef RelativeRoundtripTimeoutPolicy *RelativeRoundtripTimeoutPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -1247,14 +1297,14 @@
     RelativeRoundtripTimeoutPolicy_var (RelativeRoundtripTimeoutPolicy_ptr);
     RelativeRoundtripTimeoutPolicy_var (const RelativeRoundtripTimeoutPolicy_var &); // copy constructor
     ~RelativeRoundtripTimeoutPolicy_var (void); // destructor
-    
+
     RelativeRoundtripTimeoutPolicy_var &operator= (RelativeRoundtripTimeoutPolicy_ptr);
     RelativeRoundtripTimeoutPolicy_var &operator= (const RelativeRoundtripTimeoutPolicy_var &);
     RelativeRoundtripTimeoutPolicy_ptr operator-> (void) const;
-    
+
     operator const RelativeRoundtripTimeoutPolicy_ptr &() const;
     operator RelativeRoundtripTimeoutPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RelativeRoundtripTimeoutPolicy_ptr in (void) const;
     RelativeRoundtripTimeoutPolicy_ptr &inout (void);
     RelativeRoundtripTimeoutPolicy_ptr &out (void);
@@ -1284,7 +1334,7 @@
     operator RelativeRoundtripTimeoutPolicy_ptr &();
     RelativeRoundtripTimeoutPolicy_ptr &ptr (void);
     RelativeRoundtripTimeoutPolicy_ptr operator-> (void);
-    
+
   private:
     RelativeRoundtripTimeoutPolicy_ptr &ptr_;
   };
@@ -1308,12 +1358,12 @@
     static RelativeRoundtripTimeoutPolicy_ptr _duplicate (RelativeRoundtripTimeoutPolicy_ptr obj);
     static RelativeRoundtripTimeoutPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RelativeRoundtripTimeoutPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RelativeRoundtripTimeoutPolicy_ptr _nil (void)
@@ -1322,7 +1372,7 @@
       }
 
     virtual TimeBase::TimeT relative_expiry (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -1330,7 +1380,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -1344,11 +1394,15 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_RELATIVE_ROUNDTRIP_TIMEOUT_POLICY == 1 */
+
+#if (TAO_HAS_ROUTING_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong ROUTING_POLICY_TYPE;
 
   struct RoutingTypeRange;
   class RoutingTypeRange_var;
-  
+
   struct TAO_Export RoutingTypeRange
   {
 
@@ -1370,18 +1424,18 @@
     RoutingTypeRange_var (const RoutingTypeRange_var &); // copy constructor
     RoutingTypeRange_var (const RoutingTypeRange &); // fixed-size types only
     ~RoutingTypeRange_var (void); // destructor
-    
+
     RoutingTypeRange_var &operator= (RoutingTypeRange *);
     RoutingTypeRange_var &operator= (const RoutingTypeRange_var &);
     RoutingTypeRange_var &operator= (const RoutingTypeRange &); // fixed-size types only
     RoutingTypeRange *operator-> (void);
     const RoutingTypeRange *operator-> (void) const;
-    
+
     operator const RoutingTypeRange &() const;
     operator RoutingTypeRange &();
     operator RoutingTypeRange &() const;
-    
-    // in, inout, out, _retn 
+
+    // in, inout, out, _retn
     const RoutingTypeRange &in (void) const;
     RoutingTypeRange &inout (void);
     RoutingTypeRange &out (void);
@@ -1402,7 +1456,7 @@
 
   class RoutingPolicy;
   typedef RoutingPolicy *RoutingPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -1416,14 +1470,14 @@
     RoutingPolicy_var (RoutingPolicy_ptr);
     RoutingPolicy_var (const RoutingPolicy_var &); // copy constructor
     ~RoutingPolicy_var (void); // destructor
-    
+
     RoutingPolicy_var &operator= (RoutingPolicy_ptr);
     RoutingPolicy_var &operator= (const RoutingPolicy_var &);
     RoutingPolicy_ptr operator-> (void) const;
-    
+
     operator const RoutingPolicy_ptr &() const;
     operator RoutingPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     RoutingPolicy_ptr in (void) const;
     RoutingPolicy_ptr &inout (void);
     RoutingPolicy_ptr &out (void);
@@ -1453,7 +1507,7 @@
     operator RoutingPolicy_ptr &();
     RoutingPolicy_ptr &ptr (void);
     RoutingPolicy_ptr operator-> (void);
-    
+
   private:
     RoutingPolicy_ptr &ptr_;
   };
@@ -1477,12 +1531,12 @@
     static RoutingPolicy_ptr _duplicate (RoutingPolicy_ptr obj);
     static RoutingPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RoutingPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static RoutingPolicy_ptr _nil (void)
@@ -1491,7 +1545,7 @@
       }
 
     virtual Messaging::RoutingTypeRange routing_range (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -1499,7 +1553,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -1513,6 +1567,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_ROUTING_POLICY == 1 */
+
+#if (TAO_HAS_MAX_HOPS_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong MAX_HOPS_POLICY_TYPE;
 
 
@@ -1521,7 +1579,7 @@
 
   class MaxHopsPolicy;
   typedef MaxHopsPolicy *MaxHopsPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -1535,14 +1593,14 @@
     MaxHopsPolicy_var (MaxHopsPolicy_ptr);
     MaxHopsPolicy_var (const MaxHopsPolicy_var &); // copy constructor
     ~MaxHopsPolicy_var (void); // destructor
-    
+
     MaxHopsPolicy_var &operator= (MaxHopsPolicy_ptr);
     MaxHopsPolicy_var &operator= (const MaxHopsPolicy_var &);
     MaxHopsPolicy_ptr operator-> (void) const;
-    
+
     operator const MaxHopsPolicy_ptr &() const;
     operator MaxHopsPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     MaxHopsPolicy_ptr in (void) const;
     MaxHopsPolicy_ptr &inout (void);
     MaxHopsPolicy_ptr &out (void);
@@ -1572,7 +1630,7 @@
     operator MaxHopsPolicy_ptr &();
     MaxHopsPolicy_ptr &ptr (void);
     MaxHopsPolicy_ptr operator-> (void);
-    
+
   private:
     MaxHopsPolicy_ptr &ptr_;
   };
@@ -1596,12 +1654,12 @@
     static MaxHopsPolicy_ptr _duplicate (MaxHopsPolicy_ptr obj);
     static MaxHopsPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static MaxHopsPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static MaxHopsPolicy_ptr _nil (void)
@@ -1610,7 +1668,7 @@
       }
 
     virtual CORBA::UShort max_hops (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -1618,7 +1676,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -1632,6 +1690,10 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_MAX_HOPS_POLICY == 1 */
+
+#if (TAO_HAS_QUEUE_ORDER_POLICY == 1)
+
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong QUEUE_ORDER_POLICY_TYPE;
 
 
@@ -1640,7 +1702,7 @@
 
   class QueueOrderPolicy;
   typedef QueueOrderPolicy *QueueOrderPolicy_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -1654,14 +1716,14 @@
     QueueOrderPolicy_var (QueueOrderPolicy_ptr);
     QueueOrderPolicy_var (const QueueOrderPolicy_var &); // copy constructor
     ~QueueOrderPolicy_var (void); // destructor
-    
+
     QueueOrderPolicy_var &operator= (QueueOrderPolicy_ptr);
     QueueOrderPolicy_var &operator= (const QueueOrderPolicy_var &);
     QueueOrderPolicy_ptr operator-> (void) const;
-    
+
     operator const QueueOrderPolicy_ptr &() const;
     operator QueueOrderPolicy_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     QueueOrderPolicy_ptr in (void) const;
     QueueOrderPolicy_ptr &inout (void);
     QueueOrderPolicy_ptr &out (void);
@@ -1691,7 +1753,7 @@
     operator QueueOrderPolicy_ptr &();
     QueueOrderPolicy_ptr &ptr (void);
     QueueOrderPolicy_ptr operator-> (void);
-    
+
   private:
     QueueOrderPolicy_ptr &ptr_;
   };
@@ -1715,12 +1777,12 @@
     static QueueOrderPolicy_ptr _duplicate (QueueOrderPolicy_ptr obj);
     static QueueOrderPolicy_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static QueueOrderPolicy_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static QueueOrderPolicy_ptr _nil (void)
@@ -1729,7 +1791,7 @@
       }
 
     virtual Messaging::Ordering allowed_orders (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
@@ -1737,7 +1799,7 @@
       )) = 0;
 
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
@@ -1751,9 +1813,11 @@
 
 #endif /* end #if !defined */
 
+#endif /* TAO_HAS_QUEUE_ORDER_POLICY == 1 */
+
   struct PolicyValue;
   class PolicyValue_var;
-  
+
   struct TAO_Export PolicyValue
   {
 
@@ -1770,25 +1834,25 @@
 
     class _tao_seq_Octet;
     class _tao_seq_Octet_var;
-    
+
     // *************************************************************
     // _tao_seq_Octet
     // *************************************************************
-    
-    class TAO_Export _tao_seq_Octet : public 
+
+    class TAO_Export _tao_seq_Octet : public
 #if !defined (TAO_USE_SEQUENCE_TEMPLATES)
       TAO_Unbounded_Sequence<CORBA::Octet>
 #else /* TAO_USE_SEQUENCE_TEMPLATES */
       TAO_Unbounded_Sequence<CORBA::Octet>
-#endif /* !TAO_USE_SEQUENCE_TEMPLATES */ 
+#endif /* !TAO_USE_SEQUENCE_TEMPLATES */
     {
     public:
       _tao_seq_Octet (void); // default ctor
       _tao_seq_Octet (CORBA::ULong max); // uses max size
       _tao_seq_Octet (
-        CORBA::ULong max, 
-        CORBA::ULong length, 
-        CORBA::Octet *buffer, 
+        CORBA::ULong max,
+        CORBA::ULong length,
+        CORBA::Octet *buffer,
         CORBA::Boolean release=0
       );
       _tao_seq_Octet (const _tao_seq_Octet &); // copy ctor
@@ -1809,7 +1873,7 @@
 #endif /* TAO_NO_COPY_OCTET_SEQUENCE */
 
     };
-    
+
 #endif /* end #if !defined */
 
 
@@ -1828,19 +1892,19 @@
       _tao_seq_Octet_var (const _tao_seq_Octet_var &); // copy constructor
       _tao_seq_Octet_var (const _tao_seq_Octet &); // fixed-size base types only
       ~_tao_seq_Octet_var (void); // destructor
-      
+
       _tao_seq_Octet_var &operator= (_tao_seq_Octet *);
       _tao_seq_Octet_var &operator= (const _tao_seq_Octet_var &);
       _tao_seq_Octet_var &operator= (const _tao_seq_Octet &); // fixed-size base types only
       _tao_seq_Octet *operator-> (void);
       const _tao_seq_Octet *operator-> (void) const;
-      
+
       operator const _tao_seq_Octet &() const;
       operator _tao_seq_Octet &();
       operator _tao_seq_Octet &() const;
-      
+
       CORBA::Octet &operator[] (CORBA::ULong index);
-      // in, inout, out, _retn 
+      // in, inout, out, _retn
       const _tao_seq_Octet &in (void) const;
       _tao_seq_Octet &inout (void);
       _tao_seq_Octet *&out (void);
@@ -1870,7 +1934,7 @@
       _tao_seq_Octet *&ptr (void);
       _tao_seq_Octet *operator-> (void);
       CORBA::Octet &operator[] (CORBA::ULong index);
-      
+
     private:
       _tao_seq_Octet *&ptr_;
       // assignment from T_var not allowed
@@ -1894,18 +1958,18 @@
     PolicyValue_var (PolicyValue *);
     PolicyValue_var (const PolicyValue_var &); // copy constructor
     ~PolicyValue_var (void); // destructor
-    
+
     PolicyValue_var &operator= (PolicyValue *);
     PolicyValue_var &operator= (const PolicyValue_var &);
     PolicyValue *operator-> (void);
     const PolicyValue *operator-> (void) const;
-    
+
     operator const PolicyValue &() const;
     operator PolicyValue &();
     operator PolicyValue &() const;
     operator PolicyValue *&(); // variable-size types only
-    
-    // in, inout, out, _retn 
+
+    // in, inout, out, _retn
     const PolicyValue &in (void) const;
     PolicyValue &inout (void);
     PolicyValue *&out (void);
@@ -1927,7 +1991,7 @@
     operator PolicyValue *&();
     PolicyValue *&ptr (void);
     PolicyValue *operator-> (void);
-    
+
   private:
     PolicyValue *&ptr_;
     // assignment from T_var not allowed
@@ -1938,7 +2002,7 @@
 
 
 #if !defined (TAO_USE_SEQUENCE_TEMPLATES)
-    
+
 #if !defined (__TAO_UNBOUNDED_SEQUENCE_MESSAGING_POLICYVALUESEQ_CH_)
 #define __TAO_UNBOUNDED_SEQUENCE_MESSAGING_POLICYVALUESEQ_CH_
 
@@ -1946,9 +2010,9 @@
     {
     public:
       // = Initialization and termination methods.
-      
+
       _TAO_Unbounded_Sequence_Messaging_PolicyValueSeq (void); // Default constructor.
-      _TAO_Unbounded_Sequence_Messaging_PolicyValueSeq (CORBA::ULong maximum); 
+      _TAO_Unbounded_Sequence_Messaging_PolicyValueSeq (CORBA::ULong maximum);
       _TAO_Unbounded_Sequence_Messaging_PolicyValueSeq (CORBA::ULong maximum,
         CORBA::ULong length,
         PolicyValue *data,
@@ -1965,7 +2029,7 @@
       virtual void _allocate_buffer (CORBA::ULong length);
       virtual void _deallocate_buffer (void);
       // Implement the TAO_Base_Sequence methods (see Sequence.h)
-      
+
       PolicyValue *get_buffer (CORBA::Boolean orphan = 0);
       const PolicyValue *get_buffer (void) const;
       void replace (CORBA::ULong max,
@@ -1977,32 +2041,32 @@
 #endif /* end #if !defined */
 
 
-#endif /* !TAO_USE_SEQUENCE_TEMPLATES */ 
-  
+#endif /* !TAO_USE_SEQUENCE_TEMPLATES */
+
 #if !defined (_MESSAGING_POLICYVALUESEQ_CH_)
 #define _MESSAGING_POLICYVALUESEQ_CH_
 
   class PolicyValueSeq;
   class PolicyValueSeq_var;
-  
+
   // *************************************************************
   // PolicyValueSeq
   // *************************************************************
-  
-  class TAO_Export PolicyValueSeq : public 
+
+  class TAO_Export PolicyValueSeq : public
 #if !defined (TAO_USE_SEQUENCE_TEMPLATES)
     _TAO_Unbounded_Sequence_Messaging_PolicyValueSeq
 #else /* TAO_USE_SEQUENCE_TEMPLATES */
     TAO_Unbounded_Sequence<PolicyValue>
-#endif /* !TAO_USE_SEQUENCE_TEMPLATES */ 
+#endif /* !TAO_USE_SEQUENCE_TEMPLATES */
   {
   public:
     PolicyValueSeq (void); // default ctor
     PolicyValueSeq (CORBA::ULong max); // uses max size
     PolicyValueSeq (
-      CORBA::ULong max, 
-      CORBA::ULong length, 
-      PolicyValue *buffer, 
+      CORBA::ULong max,
+      CORBA::ULong length,
+      PolicyValue *buffer,
       CORBA::Boolean release=0
     );
     PolicyValueSeq (const PolicyValueSeq &); // copy ctor
@@ -2014,7 +2078,7 @@
 #endif /* ! __GNUC__ || g++ >= 2.8 */
 
   };
-  
+
 #endif /* end #if !defined */
 
 
@@ -2032,19 +2096,19 @@
     PolicyValueSeq_var (PolicyValueSeq *);
     PolicyValueSeq_var (const PolicyValueSeq_var &); // copy constructor
     ~PolicyValueSeq_var (void); // destructor
-    
+
     PolicyValueSeq_var &operator= (PolicyValueSeq *);
     PolicyValueSeq_var &operator= (const PolicyValueSeq_var &);
     PolicyValueSeq *operator-> (void);
     const PolicyValueSeq *operator-> (void) const;
-    
+
     operator const PolicyValueSeq &() const;
     operator PolicyValueSeq &();
     operator PolicyValueSeq &() const;
     operator PolicyValueSeq *&(); // variable-size base types only
-    
+
     PolicyValue &operator[] (CORBA::ULong index);
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     const PolicyValueSeq &in (void) const;
     PolicyValueSeq &inout (void);
     PolicyValueSeq *&out (void);
@@ -2074,7 +2138,7 @@
     PolicyValueSeq *&ptr (void);
     PolicyValueSeq *operator-> (void);
     PolicyValue &operator[] (CORBA::ULong index);
-    
+
   private:
     PolicyValueSeq *&ptr_;
     // assignment from T_var not allowed
@@ -2090,10 +2154,12 @@
 
   TAO_NAMESPACE_STORAGE_CLASS const CORBA::ULong INVOCATION_POLICIES;
 
+#if (TAO_HAS_AMI_CALLBACK == 1) || (TAO_HAS_AMI_POLLER == 1)
+
 // valuetype class
   class ExceptionHolder;
   typedef ExceptionHolder *ExceptionHolder_ptr;
-  
+
 #if !defined (_MESSAGING_EXCEPTIONHOLDER___VAR_CH_)
 #define _MESSAGING_EXCEPTIONHOLDER___VAR_CH_
 
@@ -2105,14 +2171,14 @@
     ExceptionHolder_var (const ExceptionHolder*); // (TAO extension)
     ExceptionHolder_var (const ExceptionHolder_var &); // copy constructor
     ~ExceptionHolder_var (void); // destructor
-    
+
     ExceptionHolder_var &operator= (ExceptionHolder*);
     ExceptionHolder_var &operator= (const ExceptionHolder_var &);
     ExceptionHolder* operator-> (void) const;
-    
+
     operator const ExceptionHolder* () const;
     operator ExceptionHolder* ();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     ExceptionHolder* in (void) const;
     ExceptionHolder* &inout (void);
     ExceptionHolder* &out (void);
@@ -2142,7 +2208,7 @@
     operator ExceptionHolder* &();
     ExceptionHolder* &ptr (void);
     ExceptionHolder* operator-> (void);
-    
+
   private:
     ExceptionHolder* &ptr_;
   };
@@ -2161,7 +2227,7 @@
     virtual const char* tao_repository_id ();
 
     // create () goes here
-    
+
   };
 
 #endif /* end #if !defined */
@@ -2198,25 +2264,25 @@
 
     class _tao_seq_Octet;
     class _tao_seq_Octet_var;
-    
+
     // *************************************************************
     // _tao_seq_Octet
     // *************************************************************
-    
-    class TAO_Export _tao_seq_Octet : public 
+
+    class TAO_Export _tao_seq_Octet : public
 #if !defined (TAO_USE_SEQUENCE_TEMPLATES)
       TAO_Unbounded_Sequence<CORBA::Octet>
 #else /* TAO_USE_SEQUENCE_TEMPLATES */
       TAO_Unbounded_Sequence<CORBA::Octet>
-#endif /* !TAO_USE_SEQUENCE_TEMPLATES */ 
+#endif /* !TAO_USE_SEQUENCE_TEMPLATES */
     {
     public:
       _tao_seq_Octet (void); // default ctor
       _tao_seq_Octet (CORBA::ULong max); // uses max size
       _tao_seq_Octet (
-        CORBA::ULong max, 
-        CORBA::ULong length, 
-        CORBA::Octet *buffer, 
+        CORBA::ULong max,
+        CORBA::ULong length,
+        CORBA::Octet *buffer,
         CORBA::Boolean release=0
       );
       _tao_seq_Octet (const _tao_seq_Octet &); // copy ctor
@@ -2237,7 +2303,7 @@
 #endif /* TAO_NO_COPY_OCTET_SEQUENCE */
 
     };
-    
+
 #endif /* end #if !defined */
 
 
@@ -2256,19 +2322,19 @@
       _tao_seq_Octet_var (const _tao_seq_Octet_var &); // copy constructor
       _tao_seq_Octet_var (const _tao_seq_Octet &); // fixed-size base types only
       ~_tao_seq_Octet_var (void); // destructor
-      
+
       _tao_seq_Octet_var &operator= (_tao_seq_Octet *);
       _tao_seq_Octet_var &operator= (const _tao_seq_Octet_var &);
       _tao_seq_Octet_var &operator= (const _tao_seq_Octet &); // fixed-size base types only
       _tao_seq_Octet *operator-> (void);
       const _tao_seq_Octet *operator-> (void) const;
-      
+
       operator const _tao_seq_Octet &() const;
       operator _tao_seq_Octet &();
       operator _tao_seq_Octet &() const;
-      
+
       CORBA::Octet &operator[] (CORBA::ULong index);
-      // in, inout, out, _retn 
+      // in, inout, out, _retn
       const _tao_seq_Octet &in (void) const;
       _tao_seq_Octet &inout (void);
       _tao_seq_Octet *&out (void);
@@ -2298,7 +2364,7 @@
       _tao_seq_Octet *&ptr (void);
       _tao_seq_Octet *operator-> (void);
       CORBA::Octet &operator[] (CORBA::ULong index);
-      
+
     private:
       _tao_seq_Octet *&ptr_;
       // assignment from T_var not allowed
@@ -2325,15 +2391,15 @@
     virtual void *_tao_obv_narrow (ptr_arith_t);
     virtual CORBA::Boolean _tao_marshal_v (TAO_OutputCDR &);
     virtual CORBA::Boolean _tao_unmarshal_v (TAO_InputCDR &);
-    
+
   private:
     ExceptionHolder (const ExceptionHolder &);
     void operator= (const ExceptionHolder &);
-    
+
   protected:
     virtual CORBA::Boolean _tao_marshal__Messaging_ExceptionHolder (TAO_OutputCDR &) = 0;
     virtual CORBA::Boolean _tao_unmarshal__Messaging_ExceptionHolder (TAO_InputCDR &) = 0;
-    
+
   };
 
 #endif /* end #if !defined */
@@ -2344,7 +2410,7 @@
 
   class ReplyHandler;
   typedef ReplyHandler *ReplyHandler_ptr;
-  
+
 #endif /* end #if !defined */
 
 
@@ -2358,14 +2424,14 @@
     ReplyHandler_var (ReplyHandler_ptr);
     ReplyHandler_var (const ReplyHandler_var &); // copy constructor
     ~ReplyHandler_var (void); // destructor
-    
+
     ReplyHandler_var &operator= (ReplyHandler_ptr);
     ReplyHandler_var &operator= (const ReplyHandler_var &);
     ReplyHandler_ptr operator-> (void) const;
-    
+
     operator const ReplyHandler_ptr &() const;
     operator ReplyHandler_ptr &();
-    // in, inout, out, _retn 
+    // in, inout, out, _retn
     ReplyHandler_ptr in (void) const;
     ReplyHandler_ptr &inout (void);
     ReplyHandler_ptr &out (void);
@@ -2395,7 +2461,7 @@
     operator ReplyHandler_ptr &();
     ReplyHandler_ptr &ptr (void);
     ReplyHandler_ptr operator-> (void);
-    
+
   private:
     ReplyHandler_ptr &ptr_;
   };
@@ -2419,12 +2485,12 @@
     static ReplyHandler_ptr _duplicate (ReplyHandler_ptr obj);
     static ReplyHandler_ptr _narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyHandler_ptr _unchecked_narrow (
         CORBA::Object_ptr obj,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     static ReplyHandler_ptr _nil (void)
@@ -2435,18 +2501,18 @@
     static void _tao_any_destructor (void*);
 
     virtual CORBA::Boolean _is_a (
-        const CORBA::Char *type_id, 
-        CORBA::Environment &ACE_TRY_ENV = 
+        const CORBA::Char *type_id,
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
     virtual void *_tao_QueryInterface (ptr_arith_t type);
-    
+
     virtual const char* _interface_repository_id (void) const;
 
   protected:
     ReplyHandler (void);
-    ReplyHandler (TAO_Stub *objref, 
-        TAO_ServantBase *_tao_servant = 0, 
+    ReplyHandler (TAO_Stub *objref,
+        TAO_ServantBase *_tao_servant = 0,
         CORBA::Boolean _tao_collocated = 0
       );
     virtual ~ReplyHandler (void);
@@ -2455,17 +2521,18 @@
     void operator= (const ReplyHandler &);
   };
 
+#if (TAO_HAS_SMART_PROXIES == 1)
 class TAO_Export TAO_Messaging_ReplyHandler_Default_Proxy_Factory
   {
   public:
-    
+
     TAO_Messaging_ReplyHandler_Default_Proxy_Factory (int register_proxy_factory = 1);
-    
+
     virtual ~TAO_Messaging_ReplyHandler_Default_Proxy_Factory (void);
-    
+
     virtual ReplyHandler_ptr create_proxy (
         ReplyHandler_ptr proxy,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
   };
@@ -2473,26 +2540,26 @@
 class TAO_Export TAO_Messaging_ReplyHandler_Proxy_Factory_Adapter
   {
   public:
-    
+
     friend class ACE_Singleton<TAO_Messaging_ReplyHandler_Proxy_Factory_Adapter, TAO_SYNCH_RECURSIVE_MUTEX>;
-    
+
     int register_proxy_factory (
         TAO_Messaging_ReplyHandler_Default_Proxy_Factory *df,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
-    
+
     int unregister_proxy_factory (
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
-    
+
     ReplyHandler_ptr create_proxy (
         ReplyHandler_ptr proxy,
-        CORBA::Environment &ACE_TRY_ENV = 
+        CORBA::Environment &ACE_TRY_ENV =
           TAO_default_environment ()
       );
-  
+
   protected:
     TAO_Messaging_ReplyHandler_Proxy_Factory_Adapter (void);
     ~TAO_Messaging_ReplyHandler_Proxy_Factory_Adapter (void);
@@ -2502,11 +2569,11 @@
     TAO_Messaging_ReplyHandler_Default_Proxy_Factory *proxy_factory_;
     int delete_proxy_factory_;
     TAO_SYNCH_RECURSIVE_MUTEX lock_;
-    
+
   };
 
   typedef ACE_Singleton<TAO_Messaging_ReplyHandler_Proxy_Factory_Adapter, TAO_SYNCH_RECURSIVE_MUTEX> TAO_Messaging_ReplyHandler_PROXY_FACTORY_ADAPTER;
-  
+
   class TAO_Export TAO_Messaging_ReplyHandler_Smart_Proxy_Base
     : public virtual ReplyHandler,
       public virtual TAO_Smart_Proxy_Base
@@ -2520,15 +2587,48 @@
     ::Messaging::ReplyHandler_var proxy_;
   };
 
+#endif /* TAO_HAS_SMART_PROXIES */
+
 
 #endif /* end #if !defined */
 
   TAO_NAMESPACE_STORAGE_CLASS CORBA::TypeCode_ptr _tc_ReplyHandler;
 
+#endif /* TAO_HAS_AMI_CALLBACK == 1 || TAO_HAS_AMI_POLLER == 1 */
 
 }
 TAO_NAMESPACE_CLOSE // module Messaging
 
+// Typedef for the Reply Handler Skeleton.
+// This is handcrafted not generated by the IDL compiler.
+
+class TAO_InputCDR;
+
+enum TAO_AMI_Reply_Status
+{
+  TAO_AMI_REPLY_OK,
+  // Reply is normal.
+
+  TAO_AMI_REPLY_NOT_OK,
+  // Reply is not normal and no exceptions
+
+  TAO_AMI_REPLY_USER_EXCEPTION,
+  // An user exception was raised.
+
+  TAO_AMI_REPLY_SYSTEM_EXCEPTION
+  // An system exception was raised.
+};
+
+
+#if (TAO_HAS_AMI_CALLBACK == 1)
+
+typedef void (*TAO_Reply_Handler_Skeleton)(
+    TAO_InputCDR &,
+    Messaging::ReplyHandler *,
+    CORBA::ULong reply_status,
+    CORBA::Environment &
+    );
+
 TAO_NAMESPACE  OBV_Messaging
 {
 
@@ -2536,7 +2636,7 @@
 #define _MESSAGING_EXCEPTIONHOLDER___OBV_CH_
 
   // OBV_ class
-  class ExceptionHolder : public virtual Messaging::ExceptionHolder
+  class TAO_Export ExceptionHolder : public virtual Messaging::ExceptionHolder
   {
   public:
     virtual void is_system_exception (CORBA::Boolean);    // set
@@ -2572,14 +2672,26 @@
 }
 TAO_NAMESPACE_CLOSE
 
+#endif /* TAO_HAS_AMI_CALLBACK == 1 */
+
+#if (TAO_HAS_PRIORITY_POLICIES == 1)
+
 TAO_Export void operator<<= (CORBA::Any &, const Messaging::PriorityRange &); // copying version
 TAO_Export void operator<<= (CORBA::Any &, Messaging::PriorityRange*); // noncopying version
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, Messaging::PriorityRange *&); // deprecated
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, const Messaging::PriorityRange *&);
+
+#endif /* TAO_HAS_PRIORITY_POLICIES == 1 */
+
+#if (TAO_HAS_ROUTING_POLICY == 1)
+
 TAO_Export void operator<<= (CORBA::Any &, const Messaging::RoutingTypeRange &); // copying version
 TAO_Export void operator<<= (CORBA::Any &, Messaging::RoutingTypeRange*); // noncopying version
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, Messaging::RoutingTypeRange *&); // deprecated
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, const Messaging::RoutingTypeRange *&);
+
+#endif /* TAO_HAS_ROUTING_POLICY == 1 */
+
 TAO_Export void operator<<= (CORBA::Any &, const Messaging::PolicyValue &); // copying version
 TAO_Export void operator<<= (CORBA::Any &, Messaging::PolicyValue*); // noncopying version
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, Messaging::PolicyValue *&); // deprecated
@@ -2588,6 +2700,9 @@
 TAO_Export void operator<<= (CORBA::Any &, Messaging::PolicyValueSeq*); // noncopying version
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, Messaging::PolicyValueSeq *&); // deprecated
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, const Messaging::PolicyValueSeq *&);
+
+#if (TAO_HAS_AMI_CALLBACK == 1)
+
 extern TAO_Export Messaging::ReplyHandler_ptr (*_TAO_collocation_Messaging_ReplyHandler_Stub_Factory_function_pointer) (
     CORBA::Object_ptr obj
   );
@@ -2595,15 +2710,26 @@
 TAO_Export void operator<<= (CORBA::Any &, Messaging::ReplyHandler_ptr);
 TAO_Export CORBA::Boolean operator>>= (const CORBA::Any &, Messaging::ReplyHandler *&);
 
+#endif /* TAO_HAS_AMI_CALLBACK */
+
 #ifndef __ACE_INLINE__
 
+#if (TAO_HAS_PRIORITY_POLICIES == 1)
+
 TAO_Export CORBA::Boolean operator<< (TAO_OutputCDR &, const Messaging::PriorityRange &);
 TAO_Export CORBA::Boolean operator>> (TAO_InputCDR &, Messaging::PriorityRange &);
+
+#endif /* TAO_HAS_PRIORITY_POLICIES == 1 */
+
+#if (TAO_HAS_ROUTING_POLICY == 1)
+
 TAO_Export CORBA::Boolean operator<< (TAO_OutputCDR &, const Messaging::RoutingTypeRange &);
 TAO_Export CORBA::Boolean operator>> (TAO_InputCDR &, Messaging::RoutingTypeRange &);
 TAO_Export CORBA::Boolean operator<< (TAO_OutputCDR &, const Messaging::PolicyValue &);
 TAO_Export CORBA::Boolean operator>> (TAO_InputCDR &, Messaging::PolicyValue &);
 
+#endif /* TAO_HAS_ROUTING_POLICY == 1 */
+
 #if !defined _TAO_CDR_OP_Messaging_PolicyValue__tao_seq_Octet_H_
 #define _TAO_CDR_OP_Messaging_PolicyValue__tao_seq_Octet_H_
 
@@ -2633,11 +2759,15 @@
 
 #endif /* _TAO_CDR_OP_Messaging_PolicyValueSeq_H_ */
 
-TAO_Export CORBA::Boolean operator<< (TAO_OutputCDR &, const Messaging::ExceptionHolder *); // 
+#if (TAO_HAS_AMI_CALLBACK == 1) || (TAO_HAS_AMI_POLLER == 1)
+
+TAO_Export CORBA::Boolean operator<< (TAO_OutputCDR &, const Messaging::ExceptionHolder *); //
 TAO_Export CORBA::Boolean operator>> (TAO_InputCDR &, Messaging::ExceptionHolder *&);
 TAO_Export CORBA::Boolean operator<< (TAO_OutputCDR &, const Messaging::ReplyHandler_ptr );
 TAO_Export CORBA::Boolean operator>> (TAO_InputCDR &, Messaging::ReplyHandler_ptr &);
 
+#endif /* TAO_HAS_AMI_CALLBACK == 1 || TAO_HAS_AMI_POLLER == 1 */
+
 #endif /* __ACE_INLINE__ */
 
 
@@ -2648,6 +2778,8 @@
 #if defined(_MSC_VER) && (_MSC_VER >= 1200)
 #pragma warning(pop)
 #endif /* _MSC_VER */
+
+#endif /* TAO_HAS_CORBA_MESSAGING */
 
 #include "ace/post.h"
 #endif /* ifndef */
