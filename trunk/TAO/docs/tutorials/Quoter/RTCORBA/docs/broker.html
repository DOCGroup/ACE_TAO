<!-- $Id$ -->

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Stock Broker implementation for the Stock Quoter Publisher/Subscriber Real-time CORBA Service</title>
</head>

<body
 text = "#000000"
 link = "#000fff"
 vLink= "#ff0f0f"
 aLink = "#0000ff"
 bgColor = "#ffffff">

<hr><h2>Stock Broker implementation for the Stock Quoter Publisher/Subscriber Real-time CORBA Service</h2><hr>

<h3>Implementation of StockBrokerHome interface</h3>

This interface is used to create StockBroker objects. <P>
The Stock_StockBrokerHome_i class is generated automatically by the IDL compiler (using the -GI flag),
which is a subclass of POA_Stock::StockBrokerHome class. <P>

<h4>Implementing the Constructor</h4>

The main steps of this function are described as follows: <P>

<li>Register the necessary factories and mappings with the specified orb.</li>

<PRE>
    Stock::StockName_init *stockname_factory = new Stock::StockName_init;
    orb->register_value_factory (stockname_factory->tao_repository_id (),
                                 stockname_factory
                                 ACE_ENV_ARG_PARAMETER);

    Stock::Cookie_init *cookie_factory = new Stock::Cookie_init;
    orb->register_value_factory (cookie_factory->tao_repository_id (),
                                 cookie_factory
                                 ACE_ENV_ARG_PARAMETER);

    Stock_PriorityMapping::register_mapping (orb);
</PRE>

<li>Create a new instance of the StockBroker object. And because the broker has nothing to do with the RTCORBA
mechanisms, we can activate it under the default POA. The "stock_name" and "priority" are in the arguments of
the Constructor.</li>

<PRE>
    broker_ = new Stock_StockBroker_i (orb, stock_name, priority);
    _default_POA ()->activate_object (broker_);
</PRE>

<h4>Implementing the create () member function</h4>

Return the StockBroker object created by the Constructor.

<PRE>
    return Stock::StockBroker::_duplicate (broker_->_this ());
</PRE>

<hr><h3>Implementation of StockBroker interface</h3>

This interface is used for Stock Broker server. <P>
The Stock_StockBroker_i class is generated automatically by the IDL compiler (using the -GI flag),
which is a subclass of POA_Stock::StockBroker class. <P>

<h4>Implementing the get_consumer_notifier () member function</h4>

Return the StockNameConsumer object created by the Constructor.

<PRE>
    return Stock::StockNameConsumer::_duplicate (consumer_->_this ());
</PRE>

<h4>Implementing the connect_quoter_info () member function</h4>

Duplicate a StockQuoter object using the StockQuoter object reference "c" in the argument.

<PRE>
    quoter_ = Stock::StockQuoter::_duplicate (c);
</PRE>

<h4>Implementing the disconnect_quoter_info () member function</h4>

Destroy the StockQuoter object and return it.

<PRE>
  Stock::StockQuoter_ptr old_quoter = quoter_;
  quoter_ = Stock::StockQuoter::_nil();
  return Stock::StockQuoter::_duplicate (old_quoter);
</PRE>

<h4>Implementing the get_connection_quoter_info () member function</h4>

Return the StockQuoter object.

<PRE>
  return Stock::StockQuoter::_duplicate (quoter_);
</PRE>

<hr><b>Email: </b><a href="mailto:"</a<ADDRESS>shanshan.jiang@vanderbilt.edu</ADDRESS>

</body>

</html>
