# $Id$
#
# ACE one-button test for VxWorks 5.2/3.x.
# To use:  -> < run_tests.vxworks > run_tests.log
#
# NOTE: if you build with a shared ACE library, be sure to load
# that first:
#  -> ld < ../ace/libACE.so
# and unld it after running the tests.
#
# The output logs can be checked from a Unix host:
#    % ./run_tests.check log/*.log
#
# These tests are not run because VxWorks doesn't support their functionality:
#  Mem_Map_Test (ENOTSUP: mmap)
#  SV_Shared_Memory_Test (SYSV IPC is not supported on this platform)
#  MM_Shared_Memory_Test (ENOTSUP: mmap)
#  Reactor_Exceptions_Test (C++ exceptions not supported on this platform)
#  Notify_Performance_Test (ENOTSUP: fcntl)
#  SPIPE_Test (SPIPE is not supported on this platform)
#  UPIPE_SAP_Test (UPIPE is not supported on this platform)
#  Time_Service_Test (ENOTSUP: fork)
#  Tokens_Test (ENOTSUP: fork)
#  Pipe_Test (ENOTSUP: fork)
#  Process_Mutex_Test (ENOTSUP: fork)
#  Process_Strategy_Test (ENOTSUP: flock_wrlock)
#  Enum_Interfaces_Test (ENOTSUP: ACE::get_ip_interfaces)
#
# These tests are not run because they fail, catastrophically:
#  Naming_Test (page fault)
#  Reactor_Performance_Test (unknown? doesn't appear to do anything)
#  Service_Config_Test (page fault)
# A few other tests now fail; these tests have run in previous ACE
# versions.  Their invocations are commented out below.

memShow

#### Message_Queue_Test sometimes never finishes on VxWorks.
#### ld < Message_Queue_Test
#### write 2, "Message_Queue_Test ", 19
#### ace_main; unld "Message_Queue_Test"

ld < Basic_Types_Test
write 2, "Basic_Types_Test ", 17
ace_main; unld "Basic_Types_Test"

ld < CDR_Test
write 2, "CDR_Test ", 9
ace_main; unld "CDR_Test"

ld < DLList_Test
write 2, "DLList_Test ", 13
ace_main; unld "DLList_Test"

ld < Env_Value_Test
write 2, "Env_Value_Test ", 15
ace_main; unld "Env_Value_Test"

ld < Atomic_Op_Test
write 2, "Atomic_Op_Test ", 15
ace_main; unld "Atomic_Op_Test"

ld < Semaphore_Test
write 2, "Semaphore_Test ", 15
ace_main; unld "Semaphore_Test"

ld < TSS_Test
write 2, "TSS_Test ", 9
ace_main; unld "TSS_Test"

#### Causes page fault.
#### ld < Timeprobe_Test
#### write 2, "Timeprobe_Test ", 15
#### ace_main; unld "Timeprobe_Test"

ld < Time_Value_Test
write 2, "Time_Value_Test ", 16
ace_main; unld "Time_Value_Test"

ld < High_Res_Timer_Test
write 2, "High_Res_Timer_Test ", 20
ace_main; unld "High_Res_Timer_Test"

ld < SString_Test
write 2, "SString_Test ", 13
ace_main; unld "SString_Test"

ld < Collection_Test
write 2, "Collection_Test ", 16
ace_main; unld "Collection_Test"

ld < Handle_Set_Test
write 2, "Handle_Set_Test ", 16
ace_main; unld "Handle_Set_Test"

ld < Hash_Map_Manager_Test
write 2, "Hash_Map_Manager_Test ", 22
ace_main; unld "Hash_Map_Manager_Test"

ld < Sigset_Ops_Test
write 2, "Sigset_Ops_Test ", 16
ace_main; unld "Sigset_Ops_Test"

#### ENOTSUP: semop.  This could easily be done with POSIX semaphores,
####          but ACE no longer uses them on VxWorks.
#### ld < Thread_Mutex_Test
#### write 2, "Thread_Mutex_Test ", 11
#### ace_main; unld "Thread_Mutex_Test"

ld < Timer_Queue_Test
write 2, "Timer_Queue_Test ", 17
ace_main; unld "Timer_Queue_Test"

ld < SOCK_Connector_Test
write 2, "SOCK_Connector_Test ", 20
ace_main; unld "SOCK_Connector_Test"

ld < Task_Test
write 2, "Task_Test ", 10
ace_main; unld "Task_Test"

ld < OrdMultiSet_Test
write 2, "OrdMultiSet_Test ", 17
ace_main; unld "OrdMultiSet_Test"

ld < Thread_Manager_Test
write 2, "Thread_Manager_Test ", 20
ace_main; unld "Thread_Manager_Test"

ld < Thread_Pool_Test
write 2, "Thread_Pool_Test ", 17
ace_main; unld "Thread_Pool_Test"

ld < Future_Test
write 2, "Future_Test ", 12
ace_main; unld "Future_Test"

ld < Reactors_Test
write 2, "Reactors_Test ", 14
ace_main; unld "Reactors_Test"

ld < Reactor_Notify_Test
write 2, "Reactor_Notify_Test ", 20
ace_main; unld "Reactor_Notify_Test"

ld < Reactor_Timer_Test
write 2, "Reactor_Timer_Test ", 19
ace_main; unld "Reactor_Timer_Test"

ld < Reader_Writer_Test
write 2, "Reader_Writer_Test ", 19
ace_main; unld "Reader_Writer_Test"

ld < Priority_Reactor_Test
write 2, "Priority_Reactor_Test ", 22
ace_main; unld "Priority_Reactor_Test"

ld < SOCK_Test
write 2, "SOCK_Test ", 10
ace_main; unld "SOCK_Test"

ld < MT_SOCK_Test
write 2, "MT_SOCK_Test ", 13
ace_main; unld "MT_SOCK_Test"

ld < Conn_Test
write 2, "Conn_Test ", 10
ace_main; unld "Conn_Test"

ld < Barrier_Test
write 2, "Barrier_Test ", 13
ace_main; unld "Barrier_Test"

ld < Buffer_Stream_Test
write 2, "Buffer_Stream_Test ", 19
ace_main; unld "Buffer_Stream_Test"

ld < Priority_Buffer_Test
write 2, "Priority_Buffer_Test ", 21
ace_main; unld "Priority_Buffer_Test"

#### Causes VxWorks to go to never-never land.
#### ld < Dynamic_Priority_Test
#### write 2, "Dynamic_Priority_Test ", 22
#### ace_main; unld "Dynamic_Priority_Test"

ld < Recursive_Mutex_Test
write 2, "Recursive_Mutex_Test ", 21
ace_main; unld "Recursive_Mutex_Test"

ld < Reverse_Lock_Test
write 2, "Reverse_Lock_Test ", 18
ace_main; unld "Reverse_Lock_Test"

ld < Map_Manager_Test
write 2, "Map_Manager_Test ", 17
ace_main; unld "Map_Manager_Test"

ld < Map_Test
write 2, "Map_Test ", 9
ace_main; unld "Map_Test"

ld < Message_Queue_Notifications_Test
write 2, "Message_Queue_Notifications_Test ", 33
ace_main; unld "Message_Queue_Notifications_Test"

ld < Simple_Message_Block_Test
write 2, "Simple_Message_Block_Test ", 26
ace_main; unld "Simple_Message_Block_Test"

ld < Message_Block_Test
write 2, "Message_Block_Test ", 19
ace_main; unld "Message_Block_Test"

ld < Priority_Task_Test
write 2, "Priority_Task_Test ", 19
ace_main; unld "Priority_Task_Test"

ld < IOStream_Test
write 2, "IOStream_Test ", 14
ace_main; unld "IOStream_Test"

ld < Upgradable_RW_Test
write 2, "Upgradable_RW_Test ", 19
ace_main; unld "Upgradable_RW_Test"

write 2, "\n", 1

memShow
