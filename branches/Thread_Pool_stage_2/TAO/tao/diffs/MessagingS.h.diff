--- orig/MessagingS.h	Mon Apr 30 21:01:17 2001
+++ MessagingS.h	Mon Apr 30 21:28:02 2001
@@ -1,6 +1,6 @@
 // -*- C++ -*-
 //
-// $Id$
+// $Id$
 
 // ****  Code generated by the The ACE ORB (TAO) IDL Compiler ****
 // TAO and the TAO IDL Compiler have been developed by:
@@ -23,11 +23,13 @@
 #define _TAO_IDL_ORIG_MESSAGINGS_H_
 
 #include "ace/pre.h"
-#include "TimeBaseS.h"
-#include "IOPS.h"
-#include "PolicyS.h"
-#include "PollableS.h"
-#include "MessagingC.h"
+
+#include "tao/orbconf.h"
+
+#if (TAO_HAS_CORBA_MESSAGING == 1)
+
+#include "tao/TimeBaseS.h"
+#include "tao/MessagingC.h"
 
 
 #if !defined (ACE_LACKS_PRAGMA_ONCE)
@@ -52,6 +54,9 @@
 
 TAO_NAMESPACE  POA_Messaging
 {
+
+#if (TAO_HAS_AMI_CALLBACK == 1)
+
   class ReplyHandler;
   typedef ReplyHandler *ReplyHandler_ptr;
   // Forward Classes Declaration
@@ -138,6 +143,7 @@
     );
   
   private:
+
     // Helper methods that takes care to create the proxy
     // as soon as their use is necessary.
     void create_proxy (
@@ -145,6 +151,8 @@
       CORBA::Environment &ACE_TRY_ENV
     );
     
+  private:
+
     // Caches the proxy implementations. The proxy implementation
     // are totally stateless, and those can be shared by all the
     // instances of a given IDL interface type.
@@ -179,9 +187,9 @@
     
     virtual ~_TAO_ReplyHandler_ThruPOA_Proxy_Impl (void) { }
     
-    
   };
   
+
   //
   //                ThruPOA  Proxy Impl. Declaration
   ///////////////////////////////////////////////////////////////////////
@@ -208,11 +216,17 @@
 ///////////////////////////////////////////////////////////////////////
 
 
+#endif /* TAO_HAS_AMI_CALLBACK == 1 */
+
 }
-TAO_NAMESPACE_CLOSE // module Messaging
+TAO_NAMESPACE_CLOSE
+
+#if (TAO_HAS_AMI_CALLBACK == 1)
 
 #include "MessagingS_T.h"
 
+#endif /* TAO_HAS_AMI_CALLBACK == 1 */
+
 #if defined (__ACE_INLINE__)
 #include "MessagingS.i"
 #endif /* defined INLINE */
@@ -224,6 +238,8 @@
 #if defined (__BORLANDC__)
 #pragma option pop
 #endif /* __BORLANDC__ */
+
+#endif /* TAO_HAS_CORBA_MESSAGING == 1 */
 
 #include "ace/post.h"
 #endif /* ifndef */
