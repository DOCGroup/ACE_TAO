--- PortableInterceptorC.h.old	Mon Oct 23 22:19:37 2000
+++ PortableInterceptorC.h	Mon Oct 23 22:21:26 2000
@@ -23,15 +23,16 @@
 #define _TAO_IDL_PORTABLEINTERCEPTORC_H_
 
 #include "ace/pre.h"
-#include "tao/corba.h"
+#include "tao/corbafwd.h"
 
 #if !defined (ACE_LACKS_PRAGMA_ONCE)
 # pragma once
 #endif /* ACE_LACKS_PRAGMA_ONCE */
 
-#include "tao/corbafwd.h"
 #include "DynamicC.h"
 #include "MessagingC.h"
+#include "CurrentC.h"
+#include "IOPC.h"
 
 #if defined (TAO_EXPORT_MACRO)
 #undef TAO_EXPORT_MACRO
@@ -152,8 +153,7 @@
       }
 
     virtual char * name (
-                CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        TAO_ENV_SINGLE_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -586,6 +586,8 @@
         CORBA::SystemException
       )) = 0;
 
+#if (TAO_HAS_CORBA_MESSAGING == 1)
+
     virtual Messaging::SyncScope sync_scope (
                 CORBA::Environment &ACE_TRY_ENV = 
           TAO_default_environment ()
@@ -594,6 +596,8 @@
         CORBA::SystemException
       )) = 0;
 
+#endif /* TAO_HAS_CORBA_MESSAGING == 1 */
+
     virtual PortableInterceptor::ReplyStatus reply_status (
                 CORBA::Environment &ACE_TRY_ENV = 
           TAO_default_environment ()
@@ -792,8 +796,7 @@
 
     virtual IOP::TaggedComponent * get_effective_component (
         IOP::ComponentId id,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -801,8 +804,7 @@
 
     virtual CORBA::Policy_ptr get_request_policy (
         CORBA::PolicyType type,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -811,8 +813,7 @@
     virtual void add_request_service_context (
         const IOP::ServiceContext & service_context,
         CORBA::Boolean replace,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -931,32 +932,28 @@
       }
 
     virtual CORBA::Any * sending_exception (
-                CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual CORBA::OctetSeq * object_id (
-                CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual CORBA::OctetSeq * adapter_id (
-                CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual char * target_most_derived_interface (
-                CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -964,8 +961,7 @@
 
     virtual CORBA::Policy_ptr get_server_policy (
         CORBA::PolicyType type,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -974,9 +970,8 @@
     virtual void set_slot (
         PortableInterceptor::SlotId id,
         const CORBA::Any & data,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
         PortableInterceptor::InvalidSlot
@@ -984,8 +979,7 @@
 
     virtual CORBA::Boolean target_is_a (
         const char * id,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -994,9 +988,8 @@
     virtual void add_reply_service_context (
         const IOP::ServiceContext & service_context,
         CORBA::Boolean replace,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
@@ -1114,47 +1107,42 @@
       }
 
     virtual void send_request (
-        PortableInterceptor::ClientRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        PortableInterceptor::ClientRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
         PortableInterceptor::ForwardRequest
       )) = 0;
 
     virtual void send_poll (
-        PortableInterceptor::ClientRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::ClientRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS        
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual void receive_reply (
-        PortableInterceptor::ClientRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        PortableInterceptor::ClientRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual void receive_exception (
-        PortableInterceptor::ClientRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        PortableInterceptor::ClientRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
         PortableInterceptor::ForwardRequest
       )) = 0;
 
     virtual void receive_other (
-        PortableInterceptor::ClientRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::ClientRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
@@ -1274,9 +1262,8 @@
       }
 
     virtual void receive_request_service_contexts (
-        PortableInterceptor::ServerRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::ServerRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
@@ -1284,38 +1271,34 @@
       )) = 0;
 
     virtual void receive_request (
-        PortableInterceptor::ServerRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        PortableInterceptor::ServerRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
         PortableInterceptor::ForwardRequest
       )) = 0;
 
     virtual void send_reply (
-        PortableInterceptor::ServerRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        PortableInterceptor::ServerRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual void send_exception (
-        PortableInterceptor::ServerRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
-      )
+        PortableInterceptor::ServerRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
+        )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
         PortableInterceptor::ForwardRequest
       )) = 0;
 
     virtual void send_other (
-        PortableInterceptor::ServerRequestInfo_ptr ri,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::ServerRequestInfo_ptr ri
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS        
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
@@ -1436,8 +1419,7 @@
 
     virtual CORBA::Policy_ptr get_effective_policy (
         CORBA::PolicyType type,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -1445,8 +1427,7 @@
 
     virtual void add_ior_component (
         const IOP::TaggedComponent & component,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -1455,8 +1436,7 @@
     virtual void add_ior_component_to_profile (
         const IOP::TaggedComponent & component,
         IOP::ProfileId profile_id,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        CORBA::Environment &ACE_TRY_ENV = TAO_default_environment ()
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -1575,9 +1555,8 @@
       }
 
     virtual void establish_components (
-        PortableInterceptor::IORInfo_ptr info,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::IORInfo_ptr info
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -1697,9 +1676,8 @@
 
     virtual CORBA::Policy_ptr create_policy (
         CORBA::PolicyType type,
-        const CORBA::Any & value,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        const CORBA::Any & value
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException,
@@ -2105,18 +2083,16 @@
       }
 
     virtual void pre_init (
-        PortableInterceptor::ORBInitInfo_ptr info,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::ORBInitInfo_ptr info
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
       )) = 0;
 
     virtual void post_init (
-        PortableInterceptor::ORBInitInfo_ptr info,
-        CORBA::Environment &ACE_TRY_ENV = 
-          TAO_default_environment ()
+        PortableInterceptor::ORBInitInfo_ptr info
+        TAO_ENV_ARG_DECL_WITH_DEFAULTS
       )
       ACE_THROW_SPEC ((
         CORBA::SystemException
@@ -2137,6 +2113,11 @@
 
 #endif /* end #if !defined */
 
+ TAO_NAMESPACE_STORAGE_CLASS void register_orb_initializer (
+   ORBInitializer_ptr init,
+   CORBA::Environment & = TAO_default_environment ());
+ ///< Register an ORBInitializer with the global ORBInitializer
+ ///< table.
 
 }
 TAO_NAMESPACE_CLOSE // module PortableInterceptor
--- PortableInterceptorC.cpp.old	Mon Oct 23 22:19:37 2000
+++ PortableInterceptorC.cpp	Mon Oct 23 22:20:52 2000
@@ -25,6 +25,7 @@
 #include "PortableInterceptorC.i"
 #endif /* !defined INLINE */
 
+#include "tao/CORBA_String.h"
 
 // default constructor
 PortableInterceptor::Interceptor::Interceptor (void)
