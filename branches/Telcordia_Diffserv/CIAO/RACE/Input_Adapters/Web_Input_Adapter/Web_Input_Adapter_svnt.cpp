// $Id$
//
// ****              Code generated by the                 ****
// ****  Component Integrated ACE ORB (CIAO) CIDL Compiler ****
// CIAO has been developed by:
//       Center for Distributed Object Computing
//       Washington University
//       St. Louis, MO
//       USA
//       http://www.cs.wustl.edu/~schmidt/doc-center.html
// CIDL Compiler has been developed by:
//       Institute for Software Integrated Systems
//       Vanderbilt University
//       Nashville, TN
//       USA
//       http://www.isis.vanderbilt.edu/
//
// Information about CIAO is available at:
//    http://www.dre.vanderbilt.edu/CIAO

#include "Web_Input_Adapter_svnt.h"
#include "Cookies.h"
#include "ciao/Servant_Activator.h"
#include "ciao/Port_Activator_T.h"
#include "ace/SString.h"

namespace CIAO_FACET_CIAO_RACE
{
  template <typename T>
  Component_Control_Servant_T<T>::Component_Control_Servant_T (
    ::CIAO::RACE::CCM_Component_Control_ptr executor,
    ::Components::CCMContext_ptr c)
    : executor_ ( ::CIAO::RACE::CCM_Component_Control::_duplicate (executor)),
      ctx_ ( ::Components::CCMContext::_duplicate (c))
  {
  }

  template <typename T>
  Component_Control_Servant_T<T>::~Component_Control_Servant_T (void)
  {
  }

  template <typename T>
  ::CORBA::Boolean
  Component_Control_Servant_T<T>::is_initialized (
    ACE_ENV_SINGLE_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    return this->executor_->is_initialized (
      ACE_ENV_SINGLE_ARG_PARAMETER);
  }

  template <typename T>
  void
  Component_Control_Servant_T<T>::init_component_tree (
    ::Components::CCMObject_ptr root
    ACE_ENV_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    this->executor_->init_component_tree (
      root
      ACE_ENV_ARG_PARAMETER);
  }

  template <typename T>
  ::CIAO::RACE::Component_Tree_Node *
  Component_Control_Servant_T<T>::get_component_tree (
    ACE_ENV_SINGLE_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException,
                   ::CIAO::RACE::Component_Control::TreeNotInitialized))
  {
    return this->executor_->get_component_tree (
      ACE_ENV_SINGLE_ARG_PARAMETER);
  }

  template <typename T>
  ::CIAO::RACE::AttbuteSeq *
  Component_Control_Servant_T<T>::get_component_attributes (
    const char * component_name
    ACE_ENV_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException,
                   ::CIAO::RACE::Component_Control::TreeNotInitialized,
                   ::CIAO::RACE::Component_Control::NoSuchComponent))
  {
    return this->executor_->get_component_attributes (
      component_name
      ACE_ENV_ARG_PARAMETER);
  }

  template <typename T>
  void
  Component_Control_Servant_T<T>::set_component_attribute (
    const char * component_name,
    const ::CIAO::RACE::Attbute & bute
    ACE_ENV_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException,
                   ::CIAO::RACE::Component_Control::TreeNotInitialized,
                   ::CIAO::RACE::Component_Control::NoSuchComponent))
  {
    this->executor_->set_component_attribute (
      component_name,
      bute
      ACE_ENV_ARG_PARAMETER);
  }

  template <typename T>
  ::CORBA::Object_ptr
  Component_Control_Servant_T<T>::_get_component (
    ACE_ENV_SINGLE_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    ::Components::SessionContext_var sc =
      ::Components::SessionContext::_narrow (
        this->ctx_.in ()
        ACE_ENV_ARG_PARAMETER);
    ACE_CHECK_RETURN ( ::CORBA::Object::_nil ());

    if (! ::CORBA::is_nil (sc.in ()))
    {
      return sc->get_CCM_object (
        ACE_ENV_SINGLE_ARG_PARAMETER);
    }

    ::Components::EntityContext_var ec =
    ::Components::EntityContext::_narrow (
      this->ctx_.in ()
      ACE_ENV_ARG_PARAMETER);
    ACE_CHECK_RETURN ( ::CORBA::Object::_nil ());

    if (! ::CORBA::is_nil (ec.in ()))
    {
      return ec->get_CCM_object (
        ACE_ENV_SINGLE_ARG_PARAMETER);
    }

    ACE_THROW_RETURN ( ::CORBA::INTERNAL (), 0);
  }
}

namespace CIAO_FACET_CIAO_RACE
{
  template <typename T>
  Plan_Deployment_Servant_T<T>::Plan_Deployment_Servant_T (
    ::CIAO::RACE::CCM_Plan_Deployment_ptr executor,
    ::Components::CCMContext_ptr c)
    : executor_ ( ::CIAO::RACE::CCM_Plan_Deployment::_duplicate (executor)),
      ctx_ ( ::Components::CCMContext::_duplicate (c))
  {
  }

  template <typename T>
  Plan_Deployment_Servant_T<T>::~Plan_Deployment_Servant_T (void)
  {
  }

  template <typename T>
  ::CIAO::RACE::Component_AllocationSeq *
  Plan_Deployment_Servant_T<T>::allocate_plan (
    const char * uri,
    ::CORBA::Boolean use_race
    ACE_ENV_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    return this->executor_->allocate_plan (
      uri,
      use_race
      ACE_ENV_ARG_PARAMETER);
  }

  template <typename T>
  void
  Plan_Deployment_Servant_T<T>::deploy_plan (
    const char * uri,
    ::CORBA::Boolean use_race
    ACE_ENV_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    this->executor_->deploy_plan (
      uri,
      use_race
      ACE_ENV_ARG_PARAMETER);
  }

  template <typename T>
  void
  Plan_Deployment_Servant_T<T>::teardown_plan (
    const char * uri
    ACE_ENV_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    this->executor_->teardown_plan (
      uri
      ACE_ENV_ARG_PARAMETER);
  }

  template <typename T>
  ::CIAO::RACE::Plan_UriSeq *
  Plan_Deployment_Servant_T<T>::get_deployed_plan_uris (
    ACE_ENV_SINGLE_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    return this->executor_->get_deployed_plan_uris (
      ACE_ENV_SINGLE_ARG_PARAMETER);
  }

  template <typename T>
  ::CORBA::Object_ptr
  Plan_Deployment_Servant_T<T>::_get_component (
    ACE_ENV_SINGLE_ARG_DECL)
  ACE_THROW_SPEC (( ::CORBA::SystemException))
  {
    ::Components::SessionContext_var sc =
      ::Components::SessionContext::_narrow (
        this->ctx_.in ()
        ACE_ENV_ARG_PARAMETER);
    ACE_CHECK_RETURN ( ::CORBA::Object::_nil ());

    if (! ::CORBA::is_nil (sc.in ()))
    {
      return sc->get_CCM_object (
        ACE_ENV_SINGLE_ARG_PARAMETER);
    }

    ::Components::EntityContext_var ec =
    ::Components::EntityContext::_narrow (
      this->ctx_.in ()
      ACE_ENV_ARG_PARAMETER);
    ACE_CHECK_RETURN ( ::CORBA::Object::_nil ());

    if (! ::CORBA::is_nil (ec.in ()))
    {
      return ec->get_CCM_object (
        ACE_ENV_SINGLE_ARG_PARAMETER);
    }

    ACE_THROW_RETURN ( ::CORBA::INTERNAL (), 0);
  }
}

namespace CIAO
{
  namespace RACE
  {
    namespace CIDL_Web_Input_Adapter_Impl
    {
      Web_Input_Adapter_Context::Web_Input_Adapter_Context (
        ::Components::CCMHome_ptr h,
        ::CIAO::Session_Container *c,
        Web_Input_Adapter_Servant *sv)
        : ::CIAO::Context_Impl_Base (h, c), 
          ::CIAO::Context_Impl<
              ::CIAO::RACE::CCM_Web_Input_Adapter_Context,
              Web_Input_Adapter_Servant,
              ::CIAO::RACE::Web_Input_Adapter,
              ::CIAO::RACE::Web_Input_Adapter_var
            > (h, c, sv)
      {
      }

      Web_Input_Adapter_Context::~Web_Input_Adapter_Context (void)
      {
      }

      // Operations for Web_Input_Adapter receptacles and event sources,
      // defined in ::CIAO::RACE::CCM_Web_Input_Adapter_Context.

      ::CIAO::RACE::PlanIngress_ptr
      Web_Input_Adapter_Context::get_connection_ingress (
        ACE_ENV_SINGLE_ARG_DECL_NOT_USED)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        return ::CIAO::RACE::PlanIngress::_duplicate (
          this->ciao_uses_ingress_.in ());
      }

      void
      Web_Input_Adapter_Context::connect_ingress (
        ::CIAO::RACE::PlanIngress_ptr c
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::AlreadyConnected,
                       ::Components::InvalidConnection))
      {
        if (! ::CORBA::is_nil (this->ciao_uses_ingress_.in ()))
        {
          ACE_THROW ( ::Components::AlreadyConnected ());
        }

        if ( ::CORBA::is_nil (c))
        {
          ACE_THROW ( ::Components::InvalidConnection ());
        }

        this->ciao_uses_ingress_ =
          ::CIAO::RACE::PlanIngress::_duplicate (c);
      }

      ::CIAO::RACE::PlanIngress_ptr
      Web_Input_Adapter_Context::disconnect_ingress (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::NoConnection))
      {
        if ( ::CORBA::is_nil (this->ciao_uses_ingress_.in ()))
        {
          ACE_THROW_RETURN ( ::Components::NoConnection (),
                            ::CIAO::RACE::PlanIngress::_nil ());
        }

        return this->ciao_uses_ingress_._retn ();
      }

      // CIAO-specific.

      Web_Input_Adapter_Context *
      Web_Input_Adapter_Context::_narrow (
        ::Components::SessionContext_ptr p
        ACE_ENV_ARG_DECL_NOT_USED)
      {
        return dynamic_cast<Web_Input_Adapter_Context *> (p);
      }

      Web_Input_Adapter_Servant::Web_Input_Adapter_Servant (
        ::CIAO::RACE::CCM_Web_Input_Adapter_ptr exe,
        ::Components::CCMHome_ptr h,
        const char *ins_name,
        ::CIAO::Home_Servant_Impl_Base *hs,
        ::CIAO::Session_Container *c,
        CIAO::REC_POL_MAP &rec_pol_map)
        : ::CIAO::Servant_Impl_Base (h, hs, c, rec_pol_map),
          ::CIAO::Servant_Impl<
              ::POA_CIAO::RACE::Web_Input_Adapter,
              ::CIAO::RACE::CCM_Web_Input_Adapter,
              Web_Input_Adapter_Context
            > (exe, h, hs, c, rec_pol_map),
          ins_name_ (ins_name)
      {
        ACE_NEW (this->context_,
                 Web_Input_Adapter_Context (h, c, this));

        // Set the instance id of the component on the context

        this->context_->_ciao_instance_id (this->ins_name_);

        ACE_TRY_NEW_ENV
        {
          ::Components::SessionComponent_var scom =
            ::Components::SessionComponent::_narrow (
              exe
              ACE_ENV_ARG_PARAMETER);
          ACE_TRY_CHECK;

          if (! ::CORBA::is_nil (scom.in ()))
          {
            scom->set_session_context (
              this->context_
              ACE_ENV_ARG_PARAMETER);
            ACE_TRY_CHECK;
          }

          this->populate_port_tables (
            ACE_ENV_SINGLE_ARG_PARAMETER);
          ACE_TRY_CHECK;
        }

        ACE_CATCHANY
        {
        }

        ACE_ENDTRY;
      }

      Web_Input_Adapter_Servant::~Web_Input_Adapter_Servant (void)
      {
      }

      void
      Web_Input_Adapter_Servant::set_attributes (
        const ::Components::ConfigValues &descr
        ACE_ENV_ARG_DECL)
      {
        ACE_ENV_EMIT_CODE (ACE_UNUSED_ARG (ACE_TRY_ENV));

        for ( ::CORBA::ULong i = 0; i < descr.length (); ++i)
        {
          const char *descr_name = descr[i]->name ();
          ::CORBA::Any &descr_value = descr[i]->value ();

          if (ACE_OS::strcmp (descr_name, "ifr_service_ior") == 0)
          {
            const char * _ciao_extract_val = 0;
            descr_value >>= _ciao_extract_val;
            this->ifr_service_ior (_ciao_extract_val);
            continue;
          }

          ACE_UNUSED_ARG (descr_name);
          ACE_UNUSED_ARG (descr_value);
        }
      }

      ::CIAO::RACE::Component_Control_ptr
      Web_Input_Adapter_Servant::provide_comp_control (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        if (! ::CORBA::is_nil (this->provide_comp_control_.in ()))
        {
          return ::CIAO::RACE::Component_Control::_duplicate (this->provide_comp_control_.in ());
        }

        ::CORBA::Object_var obj =
          this->provide_comp_control_i (ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Component_Control::_nil ());

        ::CIAO::RACE::Component_Control_var fo =
          ::CIAO::RACE::Component_Control::_narrow (obj.in ()
                                                    ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Component_Control::_nil ());

        this->provide_comp_control_ = fo;
        return ::CIAO::RACE::Component_Control::_duplicate (this->provide_comp_control_.in ());
      }

      ::CORBA::Object_ptr
      Web_Input_Adapter_Servant::provide_comp_control_i (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ::CORBA::Object_ptr ret =
          this->lookup_facet ("comp_control");

        if (! ::CORBA::is_nil (ret))
        {
          return ret;
        }

        ::CIAO::Port_Activator_T<
            ::CIAO_FACET_CIAO_RACE::Component_Control_Servant,
            ::CIAO::RACE::CCM_Component_Control,
            ::Components::CCMContext,
            Web_Input_Adapter_Servant
          > *tmp = 0;

        typedef ::CIAO::Port_Activator_T<
            ::CIAO_FACET_CIAO_RACE::Component_Control_Servant,
            ::CIAO::RACE::CCM_Component_Control,
            ::Components::CCMContext,
            Web_Input_Adapter_Servant
          >
        MACRO_MADNESS_TYPEDEF;

        ACE_CString obj_id (this->ins_name_);
        obj_id += "_comp_control";

        ACE_NEW_THROW_EX (tmp,
                          MACRO_MADNESS_TYPEDEF (
                            obj_id.c_str (),
                            "comp_control",
                            ::CIAO::Port_Activator::Facet,
                            0,
                            this->context_,
                            this),
                          ::CORBA::NO_MEMORY ());

        ::CIAO::Servant_Activator *sa = 
        this->container_->ports_servant_activator ();

        if (!sa->register_port_activator (tmp))
        {
          return ::CIAO::RACE::Component_Control::_nil ();
        }

        ::CORBA::Object_var obj =
          this->container_->generate_reference (
            obj_id.c_str (),
            "IDL:CIAO/RACE/Component_Control:1.0",
            ::CIAO::Container::Facet_Consumer
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Component_Control::_nil ());

        this->add_facet ("comp_control",
                         obj.in ()
                         ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Component_Control::_nil ());

        return obj._retn ();
      }

      ::CIAO::RACE::Plan_Deployment_ptr
      Web_Input_Adapter_Servant::provide_plan_depment (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        if (! ::CORBA::is_nil (this->provide_plan_depment_.in ()))
        {
          return ::CIAO::RACE::Plan_Deployment::_duplicate (this->provide_plan_depment_.in ());
        }

        ::CORBA::Object_var obj =
          this->provide_plan_depment_i (ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Plan_Deployment::_nil ());

        ::CIAO::RACE::Plan_Deployment_var fo =
          ::CIAO::RACE::Plan_Deployment::_narrow (obj.in ()
                                                  ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Plan_Deployment::_nil ());

        this->provide_plan_depment_ = fo;
        return ::CIAO::RACE::Plan_Deployment::_duplicate (this->provide_plan_depment_.in ());
      }

      ::CORBA::Object_ptr
      Web_Input_Adapter_Servant::provide_plan_depment_i (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ::CORBA::Object_ptr ret =
          this->lookup_facet ("plan_depment");

        if (! ::CORBA::is_nil (ret))
        {
          return ret;
        }

        ::CIAO::Port_Activator_T<
            ::CIAO_FACET_CIAO_RACE::Plan_Deployment_Servant,
            ::CIAO::RACE::CCM_Plan_Deployment,
            ::Components::CCMContext,
            Web_Input_Adapter_Servant
          > *tmp = 0;

        typedef ::CIAO::Port_Activator_T<
            ::CIAO_FACET_CIAO_RACE::Plan_Deployment_Servant,
            ::CIAO::RACE::CCM_Plan_Deployment,
            ::Components::CCMContext,
            Web_Input_Adapter_Servant
          >
        MACRO_MADNESS_TYPEDEF;

        ACE_CString obj_id (this->ins_name_);
        obj_id += "_plan_depment";

        ACE_NEW_THROW_EX (tmp,
                          MACRO_MADNESS_TYPEDEF (
                            obj_id.c_str (),
                            "plan_depment",
                            ::CIAO::Port_Activator::Facet,
                            0,
                            this->context_,
                            this),
                          ::CORBA::NO_MEMORY ());

        ::CIAO::Servant_Activator *sa = 
        this->container_->ports_servant_activator ();

        if (!sa->register_port_activator (tmp))
        {
          return ::CIAO::RACE::Plan_Deployment::_nil ();
        }

        ::CORBA::Object_var obj =
          this->container_->generate_reference (
            obj_id.c_str (),
            "IDL:CIAO/RACE/Plan_Deployment:1.0",
            ::CIAO::Container::Facet_Consumer
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Plan_Deployment::_nil ());

        this->add_facet ("plan_depment",
                         obj.in ()
                         ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Plan_Deployment::_nil ());

        return obj._retn ();
      }

      Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant::Web_DeploymentConsumer_dance_depment_Servant (
        ::CIAO::RACE::CCM_Web_Input_Adapter_ptr executor,
        ::CIAO::RACE::CCM_Web_Input_Adapter_Context_ptr c)
        : executor_ ( ::CIAO::RACE::CCM_Web_Input_Adapter::_duplicate (executor)),
          ctx_ ( ::CIAO::RACE::CCM_Web_Input_Adapter_Context::_duplicate (c))
      {
      }

      Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant::~Web_DeploymentConsumer_dance_depment_Servant (void)
      {
      }

      ::CORBA::Object_ptr
      Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant::_get_component (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        return this->ctx_->get_CCM_object (ACE_ENV_SINGLE_ARG_PARAMETER);
      }

      void
      Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant::push_Web_Deployment (
        ::CIAO::RACE::Web_Deployment *evt
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        this->executor_->push_dance_depment (
          evt
          ACE_ENV_ARG_PARAMETER);
      }

      // Inherited from ::Components::EventConsumerBase.
      void
      Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant::push_event (
        ::Components::EventBase *ev
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::BadEventType))
      {
        ::CIAO::RACE::Web_Deployment_var ev_type =
          ::CIAO::RACE::Web_Deployment::_downcast (ev);

        if (ev_type.in () != 0)
        {
          this->push_Web_Deployment (
            ev_type.in ()
            ACE_ENV_ARG_PARAMETER);

          return;
        }

        ACE_THROW ( ::Components::BadEventType ());
      }

      CORBA::Boolean
      Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant::ciao_is_substitutable (
        const char * event_repo_id
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        if (event_repo_id == 0)
        {
          ACE_THROW_RETURN ( ::CORBA::BAD_PARAM (), false);
        }

        Web_Input_Adapter_Context *ctx =
          Web_Input_Adapter_Context::_narrow (
            this->ctx_.in ()
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN (false);

        CORBA::ORB_ptr orb = ctx->_ciao_the_Container ()->the_ORB ();

        CORBA::ValueFactory f =
          orb->lookup_value_factory (
            event_repo_id
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN (false);

        if (f == 0)
        {
          return false;
        }

        CORBA::ValueBase_var v =
          f->create_for_unmarshal (ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK_RETURN (false);

        f->_remove_ref ();

        if (v.in () == 0)
        {
          return false;
        }

        return dynamic_cast< ::CIAO::RACE::Web_Deployment *> (v.in ()) != 0;
      }


      ::CIAO::RACE::Web_DeploymentConsumer_ptr
      Web_Input_Adapter_Servant::get_consumer_dance_depment (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        if (! ::CORBA::is_nil (this->consumes_dance_depment_.in ()))
        {
          return ::CIAO::RACE::Web_DeploymentConsumer::_duplicate (this->consumes_dance_depment_.in ());
        }

        ::Components::EventConsumerBase_var obj =
          this->get_consumer_dance_depment_i (
            ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Web_DeploymentConsumer::_nil ());

        ::CIAO::RACE::Web_DeploymentConsumer_var eco =
          ::CIAO::RACE::Web_DeploymentConsumer::_narrow (
            obj.in ()
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Web_DeploymentConsumer::_nil ());

        this->consumes_dance_depment_ = eco;
        return ::CIAO::RACE::Web_DeploymentConsumer::_duplicate (this->consumes_dance_depment_.in ());
      }

      ::Components::EventConsumerBase_ptr
      Web_Input_Adapter_Servant::get_consumer_dance_depment_i (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ::Components::EventConsumerBase_ptr ret =
          this->lookup_consumer ("dance_depment");

        if (! ::CORBA::is_nil (ret))
        {
          return ret;
        }

        ::CIAO::Port_Activator_T<
        Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant,
        ::CIAO::RACE::CCM_Web_Input_Adapter,
        ::CIAO::RACE::CCM_Web_Input_Adapter_Context,
        Web_Input_Adapter_Servant > *tmp = 0;

        typedef  CIAO::Port_Activator_T<
            Web_Input_Adapter_Servant::Web_DeploymentConsumer_dance_depment_Servant,
            ::CIAO::RACE::CCM_Web_Input_Adapter,
            ::CIAO::RACE::CCM_Web_Input_Adapter_Context, 
            Web_Input_Adapter_Servant
          >
        MACRO_MADNESS_TYPEDEF;

        ACE_CString obj_id (this->ins_name_);
        obj_id += "_dance_depment";

        ACE_NEW_THROW_EX (
          tmp,
          MACRO_MADNESS_TYPEDEF (obj_id.c_str (),
                                 "dance_depment",
                                 ::CIAO::Port_Activator::Sink,
                                 this->executor_.in (),
                                 this->context_,
                                 this),
          ::CORBA::NO_MEMORY ());

        ::CIAO::Servant_Activator *sa =
          this->container_->ports_servant_activator ();

        if (!sa->register_port_activator (tmp))
        {
          return ::CIAO::RACE::Web_DeploymentConsumer::_nil ();
        }

        ::CORBA::Object_var obj =
          this->container_->generate_reference (
            obj_id.c_str (),
            "IDL:CIAO/RACE/Web_DeploymentConsumer:1.0",
            ::CIAO::Container::Facet_Consumer
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Web_DeploymentConsumer::_nil ());

        ::Components::EventConsumerBase_var ecb =
          ::Components::EventConsumerBase::_narrow (
            obj.in ()
            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Web_DeploymentConsumer::_nil ());

        this->add_consumer ("dance_depment",
                            ecb.in ()
                            ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN ( ::CIAO::RACE::Web_DeploymentConsumer::_nil ());

        return ecb._retn ();
      }

      ::Components::Cookie *
      Web_Input_Adapter_Servant::connect (
        const char *name,
        ::CORBA::Object_ptr connection
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::InvalidName,
                       ::Components::InvalidConnection,
                       ::Components::AlreadyConnected,
                       ::Components::ExceededConnectionLimit))
      {
        // If the component has no receptacles, this will be unused.
        ACE_UNUSED_ARG (connection);

        if (name == 0)
        {
          ACE_THROW_RETURN ( ::Components::InvalidName (), 0);
        }

        if (ACE_OS::strcmp (name, "ingress") == 0)
        {
          ::CIAO::RACE::PlanIngress_var _ciao_conn =
          ::CIAO::RACE::PlanIngress::_narrow (
            connection
            ACE_ENV_ARG_PARAMETER);
          ACE_CHECK_RETURN (0);

          if ( ::CORBA::is_nil (_ciao_conn.in ()))
          {
            ACE_THROW_RETURN ( ::Components::InvalidConnection (), 0);
          }

          // Simplex connect.
          this->connect_ingress (
            _ciao_conn.in ()
            ACE_ENV_ARG_PARAMETER);
          ACE_CHECK_RETURN (0);

          return 0;
        }

        ACE_THROW_RETURN ( ::Components::InvalidName (), 0);
      }

      ::CORBA::Object_ptr
      Web_Input_Adapter_Servant::disconnect (
        const char *name,
        ::Components::Cookie * ck
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::InvalidName,
                       ::Components::InvalidConnection,
                       ::Components::CookieRequired,
                       ::Components::NoConnection))
      {
        ACE_UNUSED_ARG (ck);

        if (name == 0)
        {
          ACE_THROW_RETURN ( ::CORBA::BAD_PARAM (),
                            ::CORBA::Object::_nil ());
        }

        if (ACE_OS::strcmp (name, "ingress") == 0)
        {
          // Simplex disconnect.
          return this->disconnect_ingress (ACE_ENV_SINGLE_ARG_PARAMETER);
        }

        ACE_THROW_RETURN ( ::Components::InvalidName (),
                          ::CORBA::Object::_nil ());
      }

      ::Components::ReceptacleDescriptions *
      Web_Input_Adapter_Servant::get_all_receptacles (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ::Components::ReceptacleDescriptions *retval = 0;
        ACE_NEW_RETURN (retval,
                        ::Components::ReceptacleDescriptions,
                        0);
        ::Components::ReceptacleDescriptions_var safe_retval = retval;
        safe_retval->length (1UL);

        ::CIAO::Servant_Impl_Base::describe_simplex_receptacle<
            ::CIAO::RACE::PlanIngress_var
          > ("ingress",
             "IDL:CIAO/RACE/PlanIngress:1.0",
             this->context_->ciao_uses_ingress_,
             safe_retval,
             0UL);

        return safe_retval._retn ();
      }

      void
      Web_Input_Adapter_Servant::connect_ingress (
        ::CIAO::RACE::PlanIngress_ptr c
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::AlreadyConnected,
                       ::Components::InvalidConnection))
      {
        this->context_->connect_ingress (
          c
          ACE_ENV_ARG_PARAMETER);

        this->add_receptacle ("ingress", c, 0);
      }

      ::CIAO::RACE::PlanIngress_ptr
      Web_Input_Adapter_Servant::disconnect_ingress (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::NoConnection))
      {
        return this->context_->disconnect_ingress (
          ACE_ENV_SINGLE_ARG_PARAMETER);
      }

      ::CIAO::RACE::PlanIngress_ptr
      Web_Input_Adapter_Servant::get_connection_ingress (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        return this->context_->get_connection_ingress (
          ACE_ENV_SINGLE_ARG_PARAMETER);
      }

      void
      Web_Input_Adapter_Servant::connect_consumer (
        const char * emitter_name,
        ::Components::EventConsumerBase_ptr consumer
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::InvalidName,
                       ::Components::AlreadyConnected,
                       ::Components::InvalidConnection))
      {
        if (emitter_name == 0)
        {
          ACE_THROW ( ::CORBA::BAD_PARAM ());
        }

        ACE_UNUSED_ARG (consumer);
        ACE_THROW ( ::Components::InvalidName ());
      }

      ::Components::EventConsumerBase_ptr
      Web_Input_Adapter_Servant::disconnect_consumer (
        const char *source_name
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::InvalidName,
                       ::Components::NoConnection))
      {
        if (source_name == 0)
        {
          ACE_THROW_RETURN ( ::CORBA::BAD_PARAM (),
                            ::Components::EventConsumerBase::_nil ());
        }

        ACE_THROW_RETURN ( ::Components::InvalidName (),
                          ::Components::EventConsumerBase::_nil ());
      }

      ::Components::PublisherDescriptions *
      Web_Input_Adapter_Servant::get_all_publishers (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ::Components::PublisherDescriptions *retval = 0;
        ACE_NEW_RETURN (retval,
                        ::Components::PublisherDescriptions,
                        0);
        ::Components::PublisherDescriptions_var safe_retval = retval;
        safe_retval->length (0UL);

        return safe_retval._retn ();
      }

      ::Components::EmitterDescriptions *
      Web_Input_Adapter_Servant::get_all_emitters (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ::Components::EmitterDescriptions *retval = 0;
        ACE_NEW_RETURN (retval,
                        ::Components::EmitterDescriptions,
                        0);
        ::Components::EmitterDescriptions_var safe_retval = retval;
        safe_retval->length (0UL);

        return safe_retval._retn ();
      }

      ::Components::Cookie *
      Web_Input_Adapter_Servant::subscribe (
        const char *publisher_name,
        ::Components::EventConsumerBase_ptr subscribe
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::InvalidName,
                       ::Components::InvalidConnection,
                       ::Components::ExceededConnectionLimit))
      {
        // Just in case there are no if blocks
        ACE_UNUSED_ARG (subscribe);

        if (publisher_name == 0)
        {
          ACE_THROW_RETURN ( ::Components::InvalidName (), 0);
        }

        ACE_THROW_RETURN ( ::Components::InvalidName (), 0);
      }

      ::Components::EventConsumerBase_ptr
      Web_Input_Adapter_Servant::unsubscribe (
        const char *publisher_name,
        ::Components::Cookie *ck
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException,
                       ::Components::InvalidName,
                       ::Components::InvalidConnection))
      {
        // Just in case there are no if blocks
        ACE_UNUSED_ARG (ck);

        if (publisher_name == 0)
        {
          ACE_THROW_RETURN ( ::Components::InvalidName (),
                            ::Components::EventConsumerBase::_nil ());
        }

        ACE_THROW_RETURN ( ::Components::InvalidName (),
                          ::Components::EventConsumerBase::_nil ());
      }

      ::CORBA::Object_ptr
      Web_Input_Adapter_Servant::get_facet_executor (
        const char *name
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        if (name == 0)
        {
          ACE_THROW_RETURN ( ::CORBA::BAD_PARAM (),
                            ::CORBA::Object::_nil ());
        }

        if (ACE_OS::strcmp (name, "comp_control") == 0)
        {
          return this->executor_->get_comp_control (ACE_ENV_SINGLE_ARG_PARAMETER);
        }

        if (ACE_OS::strcmp (name, "plan_depment") == 0)
        {
          return this->executor_->get_plan_depment (ACE_ENV_SINGLE_ARG_PARAMETER);
        }

        return ::CORBA::Object::_nil ();
      }

      // Supported operations.

      // Component attribute operations.

      char *
      Web_Input_Adapter_Servant::ifr_service_ior (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        return this->executor_->ifr_service_ior (
          ACE_ENV_SINGLE_ARG_PARAMETER);
      }

      void
      Web_Input_Adapter_Servant::ifr_service_ior (
        const char * ifr_service_ior
        ACE_ENV_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        this->executor_->ifr_service_ior (
          ifr_service_ior
          ACE_ENV_ARG_PARAMETER);
      }

      // Private method to populate the port tables.
      void
      Web_Input_Adapter_Servant::populate_port_tables (
        ACE_ENV_SINGLE_ARG_DECL)
      ACE_THROW_SPEC (( ::CORBA::SystemException))
      {
        ACE_ENV_ARG_NOT_USED;
        ::CORBA::Object_var obj_var;
        ::Components::EventConsumerBase_var ecb_var;

        obj_var =
          this->provide_comp_control_i (
            ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK;

        obj_var =
          this->provide_plan_depment_i (
            ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK;

        ecb_var =
          this->get_consumer_dance_depment_i (
            ACE_ENV_SINGLE_ARG_PARAMETER);
        ACE_CHECK;
      }

      Web_Input_Adapter_Home_Servant::Web_Input_Adapter_Home_Servant (
        ::CIAO::RACE::CCM_Web_Input_Adapter_Home_ptr exe,
        const char *ins_name,
        ::CIAO::Session_Container *c,
        CIAO::REC_POL_MAP &rec_pol_map)
        : ::CIAO::Home_Servant_Impl_Base (c),
          ::CIAO::Home_Servant_Impl<
                ::POA_CIAO::RACE::Web_Input_Adapter_Home,
                ::CIAO::RACE::CCM_Web_Input_Adapter_Home,
                Web_Input_Adapter_Servant
              > (exe, c, ins_name, rec_pol_map)
      {
      }

      Web_Input_Adapter_Home_Servant::~Web_Input_Adapter_Home_Servant (void)
      {
      }

      // Home operations.

      // Home supported interface operations.

      // Home factory and finder operations.

      // Home attribute operations.

      extern "C" WEB_INPUT_ADAPTER_SVNT_Export ::PortableServer::Servant
      create_CIAO_RACE_Web_Input_Adapter_Home_Servant (
        ::Components::HomeExecutorBase_ptr p,
        ::CIAO::Session_Container *c,
        const char *ins_name,
        CIAO::REC_POL_MAP &rec_pol_map
        ACE_ENV_ARG_DECL)
      {
        if (p == 0)
        {
          return 0;
        }

        ::CIAO::RACE::CCM_Web_Input_Adapter_Home_var x =
        ::CIAO::RACE::CCM_Web_Input_Adapter_Home::_narrow (
          p
          ACE_ENV_ARG_PARAMETER);
        ACE_CHECK_RETURN (0);

        if (::CORBA::is_nil (x.in ()))
        {
          return 0;
        }

        return new
        Web_Input_Adapter_Home_Servant (
          x.in (),
          ins_name,
          c, rec_pol_map);
      }
    }
  }
}

